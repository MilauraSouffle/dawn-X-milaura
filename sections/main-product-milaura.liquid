{% comment %} Section produit Milaura Masterclass - isol√©e de la section d'origine {% endcomment %}

{% style %}
  #MilauraProduct-{{ section.id }} {
    width: 100%;
    padding-top: {{ section.settings.padding_top }}px;
    padding-bottom: {{ section.settings.padding_bottom }}px;
    background: transparent;
  }

  #MilauraProduct-{{ section.id }} .milaura-product-wrapper {
    max-width: 1400px;
    width: 92%;
    margin: 0 auto;
    background: rgba(255, 255, 255, 0.75);
    backdrop-filter: blur(20px) saturate(180%);
    -webkit-backdrop-filter: blur(20px) saturate(180%);
    border: 1px solid rgba(192, 160, 98, 0.4);
    border-radius: 30px;
    box-shadow: 0 20px 50px rgba(192, 160, 98, 0.15);
    padding: var(--milaura-spacing-xl) var(--milaura-spacing-lg);
    position: relative;
    overflow: hidden;
  }

  #MilauraProduct-{{ section.id }} .milaura-product-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: var(--milaura-spacing-xl);
    align-items: start;
  }

  /* Colonne gauche - M√©dias */
  #MilauraProduct-{{ section.id }} .milaura-product-media {
    position: sticky;
    top: calc(var(--header-height-offset) + var(--milaura-spacing-md));
  }

  #MilauraProduct-{{ section.id }} .milaura-product-image-wrapper {
    border: 3px solid var(--milaura-gold);
    border-radius: var(--milaura-border-radius);
    box-shadow: var(--milaura-shadow-md);
    overflow: hidden;
    background: #ffffff;
    margin-bottom: var(--milaura-spacing-md);
  }

  #MilauraProduct-{{ section.id }} .milaura-product-image {
    width: 100%;
    height: auto;
    display: block;
    aspect-ratio: 1;
    object-fit: cover;
  }

  #MilauraProduct-{{ section.id }} .milaura-product-thumbnails {
    display: flex;
    gap: var(--milaura-spacing-sm);
    flex-wrap: wrap;
  }

  #MilauraProduct-{{ section.id }} .milaura-thumbnail {
    width: 80px;
    height: 80px;
    border: 2px solid transparent;
    border-radius: var(--milaura-border-radius-sm);
    overflow: hidden;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  #MilauraProduct-{{ section.id }} .milaura-thumbnail:hover,
  #MilauraProduct-{{ section.id }} .milaura-thumbnail.is-active {
    border-color: var(--milaura-gold);
    transform: scale(1.05);
  }

  #MilauraProduct-{{ section.id }} .milaura-thumbnail img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  /* Colonne droite - Informations */
  #MilauraProduct-{{ section.id }} .milaura-product-info {
    display: flex;
    flex-direction: column;
    gap: var(--milaura-spacing-lg);
  }

  /* Header */
  #MilauraProduct-{{ section.id }} .milaura-product-header h1 {
    font-family: var(--milaura-font-heading);
    font-size: 3rem;
    font-weight: 900;
    color: var(--milaura-text);
    margin-bottom: var(--milaura-spacing-xs);
  }

  #MilauraProduct-{{ section.id }} .milaura-product-subtitle {
    font-family: var(--milaura-font-body);
    font-size: 1.1rem;
    font-weight: 400;
    color: var(--milaura-text-light);
    margin-bottom: var(--milaura-spacing-md);
    line-height: 1.6;
  }

  #MilauraProduct-{{ section.id }} .milaura-product-price {
    font-family: var(--milaura-font-heading);
    font-size: 2rem;
    font-weight: 700;
    color: var(--milaura-gold);
    margin-bottom: var(--milaura-spacing-xs);
  }

  #MilauraProduct-{{ section.id }} .milaura-product-price-compare {
    text-decoration: line-through;
    color: var(--milaura-text-light);
    font-size: 1.5rem;
    margin-left: var(--milaura-spacing-sm);
  }

  #MilauraProduct-{{ section.id }} .milaura-product-taxes {
    font-size: 0.9rem;
    color: var(--milaura-text-light);
    margin-bottom: var(--milaura-spacing-md);
  }

  #MilauraProduct-{{ section.id }} .milaura-product-rating {
    display: flex;
    align-items: center;
    gap: var(--milaura-spacing-sm);
    margin-bottom: var(--milaura-spacing-md);
    font-family: var(--milaura-font-body);
    font-size: 0.95rem;
    color: var(--milaura-text-light);
  }

  #MilauraProduct-{{ section.id }} .milaura-stars {
    display: flex;
    gap: 4px;
    color: var(--milaura-gold);
  }

  #MilauraProduct-{{ section.id }} .milaura-stars .star {
    font-size: 1.2rem;
  }

  /* Bloc Identit√© Pierre */
  #MilauraProduct-{{ section.id }} .milaura-stone-identity {
    background: rgba(255, 255, 255, 0.6);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    border: 1px solid rgba(192, 160, 98, 0.3);
    border-radius: var(--milaura-border-radius);
    padding: var(--milaura-spacing-md);
    box-shadow: var(--milaura-shadow-sm);
  }

  #MilauraProduct-{{ section.id }} .milaura-stone-identity-item {
    display: flex;
    align-items: center;
    gap: var(--milaura-spacing-sm);
    margin-bottom: var(--milaura-spacing-sm);
    font-family: var(--milaura-font-body);
    font-size: 1rem;
    color: var(--milaura-text);
  }

  #MilauraProduct-{{ section.id }} .milaura-stone-identity-item:last-child {
    margin-bottom: 0;
  }

  #MilauraProduct-{{ section.id }} .milaura-stone-identity-item strong {
    color: var(--milaura-gold);
    font-weight: 700;
  }

  /* Bloc B√©n√©fices */
  #MilauraProduct-{{ section.id }} .milaura-benefits-block h3 {
    font-family: var(--milaura-font-heading);
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--milaura-text);
    margin-bottom: var(--milaura-spacing-sm);
  }

  #MilauraProduct-{{ section.id }} .milaura-benefits-content {
    font-family: var(--milaura-font-body);
    font-size: 1rem;
    line-height: 1.7;
    color: var(--milaura-text);
  }

  /* Bloc Urgence & Rassurance */
  #MilauraProduct-{{ section.id }} .milaura-urgency-block {
    background: rgba(192, 160, 98, 0.1);
    border-left: 3px solid var(--milaura-gold);
    border-radius: var(--milaura-border-radius-sm);
    padding: var(--milaura-spacing-md);
    margin-bottom: var(--milaura-spacing-md);
  }

  #MilauraProduct-{{ section.id }} .milaura-urgency-text {
    font-family: var(--milaura-font-body);
    font-weight: 600;
    color: var(--milaura-text);
    margin: 0;
  }

  #MilauraProduct-{{ section.id }} .milaura-reassurance-text {
    font-family: var(--milaura-font-body);
    font-size: 0.9rem;
    color: var(--milaura-text-light);
    margin-top: var(--milaura-spacing-sm);
    text-align: center;
  }

  /* Formulaire d'achat */
  #MilauraProduct-{{ section.id }} .milaura-product-form {
    display: flex;
    flex-direction: column;
    gap: var(--milaura-spacing-md);
  }

  #MilauraProduct-{{ section.id }} .milaura-variant-picker {
    display: flex;
    flex-wrap: wrap;
    gap: var(--milaura-spacing-sm);
    margin-bottom: var(--milaura-spacing-md);
  }

  #MilauraProduct-{{ section.id }} .milaura-variant-option {
    padding: 12px 24px;
    border: 2px solid rgba(192, 160, 98, 0.3);
    border-radius: var(--milaura-border-radius-lg);
    background: rgba(255, 255, 255, 0.8);
    cursor: pointer;
    transition: all 0.3s ease;
    font-family: var(--milaura-font-body);
    font-weight: 600;
    color: var(--milaura-text);
  }

  #MilauraProduct-{{ section.id }} .milaura-variant-option:hover {
    border-color: var(--milaura-gold);
    background: rgba(255, 255, 255, 1);
    transform: translateY(-2px);
  }

  #MilauraProduct-{{ section.id }} .milaura-variant-option.is-selected {
    background: var(--milaura-gold);
    color: white;
    border-color: var(--milaura-gold);
  }

  #MilauraProduct-{{ section.id }} .milaura-add-to-cart {
    width: 100%;
    padding: 20px 50px;
    background: var(--milaura-gold);
    color: white;
    font-family: var(--milaura-font-heading);
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 2px;
    font-size: 1rem;
    border: none;
    border-radius: var(--milaura-border-radius-lg);
    cursor: pointer;
    box-shadow: var(--milaura-shadow-md);
    transition: all 0.3s ease;
  }

  #MilauraProduct-{{ section.id }} .milaura-add-to-cart:hover {
    background: var(--milaura-gold-dark);
    transform: translateY(-2px);
    box-shadow: var(--milaura-shadow-lg);
  }

  #MilauraProduct-{{ section.id }} .milaura-add-to-cart:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    transform: none;
  }

  #MilauraProduct-{{ section.id }} .milaura-payment-note {
    text-align: center;
    font-size: 0.85rem;
    color: var(--milaura-text-light);
    font-family: var(--milaura-font-body);
  }

  /* Accord√©ons */
  #MilauraProduct-{{ section.id }} .milaura-accordions {
    display: flex;
    flex-direction: column;
    gap: var(--milaura-spacing-sm);
    margin-top: var(--milaura-spacing-md);
  }

  #MilauraProduct-{{ section.id }} .milaura-accordion {
    border: 1px solid rgba(192, 160, 98, 0.2);
    border-radius: var(--milaura-border-radius-sm);
    overflow: hidden;
    background: rgba(255, 255, 255, 0.5);
  }

  #MilauraProduct-{{ section.id }} .milaura-accordion-header {
    padding: var(--milaura-spacing-md);
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
    font-family: var(--milaura-font-heading);
    font-weight: 700;
    color: var(--milaura-text);
    transition: all 0.3s ease;
  }

  #MilauraProduct-{{ section.id }} .milaura-accordion-header:hover {
    background: rgba(192, 160, 98, 0.1);
  }

  #MilauraProduct-{{ section.id }} .milaura-accordion-icon {
    transition: transform 0.3s ease;
    font-size: 1.2rem;
    color: var(--milaura-gold);
  }

  #MilauraProduct-{{ section.id }} .milaura-accordion.is-open .milaura-accordion-icon {
    transform: rotate(180deg);
  }

  #MilauraProduct-{{ section.id }} .milaura-accordion-content {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
  }

  #MilauraProduct-{{ section.id }} .milaura-accordion.is-open .milaura-accordion-content {
    max-height: 1000px;
  }

  #MilauraProduct-{{ section.id }} .milaura-accordion-body {
    padding: 0 var(--milaura-spacing-md) var(--milaura-spacing-md);
    font-family: var(--milaura-font-body);
    line-height: 1.7;
    color: var(--milaura-text);
  }

  /* Responsive */
  @media screen and (max-width: 1024px) {
    #MilauraProduct-{{ section.id }} .milaura-product-wrapper {
      width: calc(100% - 2 * var(--milaura-spacing-sm));
      padding: var(--milaura-spacing-lg) var(--milaura-spacing-md);
      border-radius: 25px;
    }

    #MilauraProduct-{{ section.id }} .milaura-product-grid {
      gap: var(--milaura-spacing-lg);
    }
  }

  @media screen and (max-width: 768px) {
    #MilauraProduct-{{ section.id }} .milaura-product-wrapper {
      width: calc(100% - 2 * var(--milaura-spacing-sm));
      padding: calc(var(--milaura-spacing-lg) * 0.7) calc(var(--milaura-spacing-md) * 0.7);
      border-radius: 14px;
    }

    #MilauraProduct-{{ section.id }} .milaura-product-grid {
      grid-template-columns: 1fr;
      gap: var(--milaura-spacing-md);
    }

    #MilauraProduct-{{ section.id }} .milaura-product-media {
      position: static;
    }

    #MilauraProduct-{{ section.id }} .milaura-product-header h1 {
      font-size: 2rem;
    }

    #MilauraProduct-{{ section.id }} .milaura-product-price {
      font-size: 1.5rem;
    }
  }
{% endstyle %}

<section id="MilauraProduct-{{ section.id }}" class="milaura-product-section">
  <div class="milaura-product-wrapper">
    <div class="milaura-product-grid">
      <!-- Colonne gauche - M√©dias -->
      <div class="milaura-product-media">
        <div class="milaura-product-image-wrapper">
          {% if product.featured_media %}
            <img
              src="{{ product.featured_media | image_url: width: 800 }}"
              alt="{{ product.featured_media.alt | escape }}"
              class="milaura-product-image"
              id="milaura-main-image-{{ section.id }}"
              width="800"
              height="800"
              loading="lazy"
            >
          {% else %}
            {{ 'product-1' | placeholder_svg_tag: 'milaura-product-image' }}
          {% endif %}
        </div>
        {% if product.media.size > 1 %}
          <div class="milaura-product-thumbnails">
            {% for media in product.media limit: 5 %}
              <div
                class="milaura-thumbnail {% if forloop.first %}is-active{% endif %}"
                data-image="{{ media | image_url: width: 800 }}"
              >
                <img
                  src="{{ media | image_url: width: 150 }}"
                  alt="{{ media.alt | escape }}"
                  width="150"
                  height="150"
                  loading="lazy"
                >
              </div>
            {% endfor %}
          </div>
        {% endif %}
      </div>

      <!-- Colonne droite - Informations -->
      <div class="milaura-product-info">
        <!-- Header : Titre et sous-titre -->
        <div class="milaura-product-header">
          <h1>{{ product.title }}</h1>
          {% if product.metafields.custom.subtitle %}
            <p class="milaura-product-subtitle">{{ product.metafields.custom.subtitle }}</p>
          {% endif %}
        </div>

        <!-- Bloc rating / preuve sociale -->
        <div class="milaura-product-rating">
          <div class="milaura-stars">
            <span class="star">‚òÖ</span>
            <span class="star">‚òÖ</span>
            <span class="star">‚òÖ</span>
            <span class="star">‚òÖ</span>
            <span class="star">‚òÖ</span>
          </div>
          <span>4,9/5 bas√© sur plus de 120 avis clients</span>
        </div>

        <!-- Bloc prix -->
        <div class="milaura-product-price">
          {% if product.selected_or_first_available_variant.compare_at_price
              > product.selected_or_first_available_variant.price
          %}
            <span class="milaura-product-price-compare">
              {{- product.selected_or_first_available_variant.compare_at_price | money -}}
            </span>
          {% endif %}
          {{ product.selected_or_first_available_variant.price | money }}
        </div>
        <p class="milaura-product-taxes">Taxes incluses</p>

        <!-- Bloc d'urgence -->
        {% if section.settings.urgency_text != blank %}
          <div class="milaura-urgency-block">
            <p class="milaura-urgency-text">{{ section.settings.urgency_text }}</p>
          </div>
        {% endif %}

        <!-- Formulaire d'achat -->
        <form
          action="{{ routes.cart_add_url }}"
          method="post"
          enctype="multipart/form-data"
          class="milaura-product-form"
          id="milaura-product-form-{{ section.id }}"
        >
          <input
            type="hidden"
            name="id"
            value="{{ product.selected_or_first_available_variant.id }}"
            id="milaura-variant-id-{{ section.id }}"
          >

          {% unless product.has_only_default_variant %}
            <div class="milaura-variant-picker">
              {% for option in product.options_with_values %}
                <div class="milaura-variant-group">
                  <label style="display: block; margin-bottom: var(--milaura-spacing-xs); font-weight: 600; color: var(--milaura-text);">
                    {{ option.name }}
                  </label>
                  <div style="display: flex; flex-wrap: wrap; gap: var(--milaura-spacing-sm);">
                    {% for value in option.values %}
                      <button
                        type="button"
                        class="milaura-variant-option {% if option.selected_value == value %}is-selected{% endif %}"
                        data-option="{{ option.name }}"
                        data-value="{{ value }}"
                      >
                        {{ value }}
                      </button>
                    {% endfor %}
                  </div>
                </div>
              {% endfor %}
            </div>
          {% endunless %}

          <div class="milaura-quantity-wrapper" style="margin-bottom: var(--milaura-spacing-md);">
            <label
              for="Quantity-{{ section.id }}"
              style="display: block; margin-bottom: var(--milaura-spacing-xs); font-weight: 600; color: var(--milaura-text);"
            >
              Quantit√©
            </label>
            {% render 'quantity-input', variant: product.selected_or_first_available_variant %}
          </div>

          <button type="submit" class="milaura-add-to-cart" id="milaura-add-to-cart-{{ section.id }}">
            AJOUTER AU PANIER
          </button>
          {% if section.settings.reassurance_text != blank %}
            <p class="milaura-reassurance-text">{{ section.settings.reassurance_text }}</p>
          {% endif %}
        </form>

        <!-- Bloc Identit√© Pierre -->
        {% if product.metafields.custom.stone
          or product.metafields.custom.quality
          or product.metafields.custom.origin
        %}
          <div class="milaura-stone-identity">
            {% if product.metafields.custom.stone %}
              <div class="milaura-stone-identity-item">
                <span>üíé</span>
                <strong>Pierre :</strong>
                <span>{{ product.metafields.custom.stone }}</span>
              </div>
            {% endif %}
            {% if product.metafields.custom.quality %}
              <div class="milaura-stone-identity-item">
                <span>‚ú®</span>
                <strong>Qualit√© :</strong>
                <span>{{ product.metafields.custom.quality }}</span>
              </div>
            {% endif %}
            {% if product.metafields.custom.origin %}
              <div class="milaura-stone-identity-item">
                <span>üåç</span>
                <strong>Provenance :</strong>
                <span>{{ product.metafields.custom.origin }}</span>
              </div>
            {% endif %}
          </div>
        {% endif %}

        <!-- Bloc B√©n√©fices -->
        {% if product.metafields.custom.benefits %}
          <div class="milaura-benefits-block">
            <h3>{{ section.settings.benefits_title | default: 'Pourquoi elle est faite pour toi :' }}</h3>
            <div class="milaura-benefits-content">
              {% assign benefits_text = product.metafields.custom.benefits | strip %}
              {% if benefits_text contains '\n' or benefits_text contains '<br>' %}
                <ul>
                  {% assign benefits_lines = benefits_text | split: '\n' %}
                  {% for line in benefits_lines %}
                    {% assign clean_line = line | strip %}
                    {% if clean_line != blank %}
                      <li>{{ clean_line }}</li>
                    {% endif %}
                  {% endfor %}
                </ul>
              {% else %}
                <p>{{ product.metafields.custom.benefits }}</p>
              {% endif %}
            </div>
          </div>
        {% endif %}

        <!-- Accord√©ons -->
        <div class="milaura-accordions">
          <div class="milaura-accordion {% if section.settings.accordion_1_open %}is-open{% endif %}">
            <div class="milaura-accordion-header">
              <span>Description & Histoire</span>
              <span class="milaura-accordion-icon">‚ñº</span>
            </div>
            <div class="milaura-accordion-content">
              <div class="milaura-accordion-body">
                {{ product.description }}
              </div>
            </div>
          </div>

          <div class="milaura-accordion">
            <div class="milaura-accordion-header">
              <span>D√©tails techniques</span>
              <span class="milaura-accordion-icon">‚ñº</span>
            </div>
            <div class="milaura-accordion-content">
              <div class="milaura-accordion-body">
                {{
                  section.settings.technical_details
                  | default: 'Poids, dimensions et informations compl√©mentaires √† venir.'
                }}
              </div>
            </div>
          </div>

          <div class="milaura-accordion">
            <div class="milaura-accordion-header">
              <span>Livraison & retours</span>
              <span class="milaura-accordion-icon">‚ñº</span>
            </div>
            <div class="milaura-accordion-content">
              <div class="milaura-accordion-body">
                {{
                  section.settings.shipping_returns
                  | default: 'Informations de livraison et politique de retours √† venir.'
                }}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  (function() {
    const sectionId = '{{ section.id }}';
    const form = document.getElementById('milaura-product-form-' + sectionId);
    const variantInput = document.getElementById('milaura-variant-id-' + sectionId);
    const addToCartBtn = document.getElementById('milaura-add-to-cart-' + sectionId);
    const mainImage = document.getElementById('milaura-main-image-' + sectionId);
    const priceElement = document.querySelector('#MilauraProduct-' + sectionId + ' .milaura-product-price');

    // Gestion des thumbnails
    const thumbnails = document.querySelectorAll('#MilauraProduct-' + sectionId + ' .milaura-thumbnail');
    thumbnails.forEach(thumb => {
      thumb.addEventListener('click', function() {
        const imageUrl = this.dataset.image;
        if (mainImage && imageUrl) {
          mainImage.src = imageUrl;
          thumbnails.forEach(t => t.classList.remove('is-active'));
          this.classList.add('is-active');
        }
      });
    });

    // Gestion des variantes
    {% unless product.has_only_default_variant %}
      const variantOptions = document.querySelectorAll('#MilauraProduct-' + sectionId + ' .milaura-variant-option');
      const variants = {{ product.variants | json }};
      const options = {{ product.options_with_values | json }};

      variantOptions.forEach(option => {
        option.addEventListener('click', function(e) {
          e.preventDefault();
          const optionName = this.dataset.option;
          const optionValue = this.dataset.value;

          // Mettre √† jour l'√©tat visuel
          const sameGroup = document.querySelectorAll(`[data-option="${optionName}"]`);
          sameGroup.forEach(btn => btn.classList.remove('is-selected'));
          this.classList.add('is-selected');

          // Trouver la variante correspondante
          const selectedOptions = {};
          document.querySelectorAll('#MilauraProduct-' + sectionId + ' .milaura-variant-option.is-selected').forEach(selected => {
            selectedOptions[selected.dataset.option] = selected.dataset.value;
          });

          const matchingVariant = variants.find(variant => {
            return options.every((option, index) => {
              return variant.options[index] === selectedOptions[option.name];
            });
          });

          if (matchingVariant) {
            variantInput.value = matchingVariant.id;
            
            // Mettre √† jour le prix
            if (priceElement) {
              const price = new Intl.NumberFormat('fr-FR', {
                style: 'currency',
                currency: 'EUR'
              }).format(matchingVariant.price / 100);
              
              let priceHtml = price;
              if (matchingVariant.compare_at_price && matchingVariant.compare_at_price > matchingVariant.price) {
                const comparePrice = new Intl.NumberFormat('fr-FR', {
                  style: 'currency',
                  currency: 'EUR'
                }).format(matchingVariant.compare_at_price / 100);
                priceHtml += ` <span class="milaura-product-price-compare">${comparePrice}</span>`;
              }
              priceElement.innerHTML = priceHtml;
            }

            // Mettre √† jour l'image si la variante a une image
            if (matchingVariant.featured_media && mainImage) {
              mainImage.src = matchingVariant.featured_media.preview_image.src;
            }
          }
        });
      });
    {% endunless %}

    // Gestion du formulaire
    if (form) {
      form.addEventListener('submit', function(e) {
        e.preventDefault();
        
        if (addToCartBtn) {
          addToCartBtn.disabled = true;
          addToCartBtn.textContent = 'AJOUT...';
        }

        // R√©cup√©rer la quantit√© depuis l'input
        const quantityInput = form.querySelector('.quantity__input');
        const quantity = quantityInput ? parseInt(quantityInput.value) || 1 : 1;

        fetch('{{ routes.cart_add_url }}', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'X-Requested-With': 'XMLHttpRequest'
          },
          body: JSON.stringify({
            items: [{
              id: variantInput.value,
              quantity: quantity
            }]
          })
        })
        .then(response => response.json())
        .then(data => {
          // Rafra√Æchir le panier
          document.dispatchEvent(new CustomEvent('cart:refresh'));
          
          if (addToCartBtn) {
            addToCartBtn.disabled = false;
            addToCartBtn.textContent = 'AJOUT√â AU PANIER ‚úì';
            setTimeout(() => {
              addToCartBtn.textContent = 'AJOUTER AU PANIER';
            }, 2000);
          }
        })
        .catch(error => {
          console.error('Erreur:', error);
          if (addToCartBtn) {
            addToCartBtn.disabled = false;
            addToCartBtn.textContent = 'ERREUR - R√âESSAYER';
            setTimeout(() => {
              addToCartBtn.textContent = 'AJOUTER AU PANIER';
            }, 2000);
          }
        });
      });
    }

    // Gestion des accord√©ons
    const accordions = document.querySelectorAll('#MilauraProduct-' + sectionId + ' .milaura-accordion');
    accordions.forEach(accordion => {
      const header = accordion.querySelector('.milaura-accordion-header');
      if (header) {
        header.addEventListener('click', function() {
          accordion.classList.toggle('is-open');
        });
      }
    });
  })();
</script>

{% schema %}
{
  "name": "Milaura Masterclass",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "benefits_title",
      "label": "Titre du bloc b√©n√©fices",
      "default": "Pourquoi elle est faite pour toi :"
    },
    {
      "type": "text",
      "id": "urgency_text",
      "label": "Texte d'urgence",
      "default": "üî• Tr√®s populaire ‚Äî stock limit√©."
    },
    {
      "type": "text",
      "id": "reassurance_text",
      "label": "Texte de rassurance",
      "default": "üöö Livraison offerte d√®s 2 articles."
    },
    {
      "type": "richtext",
      "id": "technical_details",
      "label": "D√©tails techniques",
      "default": "<p>Poids, dimensions et informations compl√©mentaires √† venir.</p>"
    },
    {
      "type": "richtext",
      "id": "shipping_returns",
      "label": "Livraison & retours",
      "default": "<p>Informations de livraison et politique de retours √† venir.</p>"
    },
    {
      "type": "checkbox",
      "id": "accordion_1_open",
      "label": "Ouvrir le premier accord√©on par d√©faut",
      "default": false
    },
    {
      "type": "header",
      "content": "Espacement"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Espacement haut",
      "default": 36
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Espacement bas",
      "default": 36
    }
  ],
  "presets": [
    {
      "name": "Milaura Masterclass"
    }
  ]
}
{% endschema %}
