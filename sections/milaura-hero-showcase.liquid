{% style %}
  /* ============================================
     MILAURA HERO SHOWCASE - LUXE & CONVERSION (clean + smooth)
     ============================================ */

  #MilauraHeroShowcase-{{ section.id }} {
    width: 100%;
    padding-top: var(--header-height-offset, 120px);
    padding-bottom: var(--milaura-spacing-lg, 32px);
    background: transparent;
    margin-top: var(--milaura-spacing-md, 18px);
    margin-bottom: var(--milaura-spacing-lg, 32px);

    /* Fallbacks s√ªrs (m√™me si base.css n'a pas tes variables) */
    --milaura-radius: var(--milaura-border-radius, 18px);
    --milaura-text: var(--milaura-text, #1b1b1b);
    --milaura-text-light: var(--milaura-text-light, rgba(27, 27, 27, 0.72));
    --milaura-beige: var(--milaura-beige, #f7f3ea);
    --milaura-shadow-md: var(--milaura-shadow-md, 0 18px 45px rgba(0,0,0,0.08));
    --milaura-font-heading: var(--milaura-font-heading, inherit);
    --milaura-font-body: var(--milaura-font-body, inherit);

    /* Dor√© "bijou" interne √† la section (pas d√©pendant du global) */
    --milaura-gold-ink: #2a1c07;
    --milaura-gold-a: 0.92;

    --milaura-gold-grad: linear-gradient(
      135deg,
      rgba(255, 240, 200, var(--milaura-gold-a)) 0%,
      rgba(214, 176, 96, var(--milaura-gold-a)) 18%,
      rgba(255, 232, 172, var(--milaura-gold-a)) 42%,
      rgba(176, 130, 48, var(--milaura-gold-a)) 70%,
      rgba(255, 240, 200, var(--milaura-gold-a)) 100%
    );

    --milaura-gold-sheen: linear-gradient(
      120deg,
      transparent 0%,
      rgba(255, 255, 255, 0.50) 35%,
      transparent 70%
    );

    --milaura-gold-border: rgba(214, 176, 96, 0.75);
    --milaura-gold-glow: rgba(214, 176, 96, 0.28);
  }

  /* Pr√©f√©rences accessibilit√© */
  @media (prefers-reduced-motion: reduce) {
    #MilauraHeroShowcase-{{ section.id }} * {
      transition: none !important;
      animation: none !important;
      scroll-behavior: auto !important;
    }
  }

  /* --- CONTENEUR --- */
  #MilauraHeroShowcase-{{ section.id }} .hero-card {
    position: relative;
  }

  /* --- HEADER --- */
  #MilauraHeroShowcase-{{ section.id }} .hero-header {
    text-align: center;
    margin-bottom: var(--milaura-spacing-lg, 32px);
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-banner-wrap {
    position: relative;
    max-width: 960px;
    margin: 0 auto var(--milaura-spacing-lg, 32px) auto;
  }

  /* --- BANDEAU DOR√â (bijou) --- */
  #MilauraHeroShowcase-{{ section.id }} .hero-banner {
    position: relative;
    z-index: 2;
    overflow: hidden;

    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--milaura-spacing-sm, 10px);
    padding: 22px 32px;
    border-radius: 32px;

    background: var(--milaura-gold-grad);
    box-shadow:
      0 20px 55px rgba(130, 90, 30, 0.22),
      0 0 0 1px rgba(255, 255, 255, 0.32) inset,
      0 0 0 1px rgba(214, 176, 96, 0.22);

    color: #fff;
  }

  /* Voile lumineux subtil (statique), et sheen au hover (pas en boucle, donc pas de lag) */
  #MilauraHeroShowcase-{{ section.id }} .hero-banner::before {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(1200px 300px at 20% 0%, rgba(255,255,255,0.22), transparent 55%);
    opacity: 0.85;
    pointer-events: none;
    z-index: 1;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-banner::after {
    content: '';
    position: absolute;
    inset: -40% -60%;
    background: var(--milaura-gold-sheen);
    opacity: 0;
    transform: translateX(-18%);
    transition: opacity 380ms ease, transform 600ms cubic-bezier(0.22, 1, 0.36, 1);
    pointer-events: none;
    z-index: 1;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-banner:hover::after {
    opacity: 0.35;
    transform: translateX(18%);
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-banner-text {
    position: relative;
    z-index: 2;
    /* Ombre port√©e renforc√©e pour meilleure lisibilit√© sur fond dor√© */
    text-shadow:
      0 1px 3px rgba(0,0,0,0.4),
      0 2px 8px rgba(0,0,0,0.35),
      0 4px 16px rgba(0,0,0,0.25);
  }

  /* --- LOGO "chapeau" (corrig√©: px + int√©gration douce) --- */
  #MilauraHeroShowcase-{{ section.id }} .hero-banner-logo {
    position: absolute;
    top: -30px;
    right: -30px;
    z-index: 3;
    pointer-events: none;
    opacity: 0.92;
    filter: saturate(1.05);
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-banner-logo img {
    display: block;
    width: 140px;
    height: auto;
    filter: drop-shadow(0 12px 28px rgba(0, 0, 0, 0.22));
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-kicker {
    font-family: var(--milaura-font-body);
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 2px;
    color: rgba(255, 255, 255, 0.98);
    font-weight: 650;
    margin-bottom: var(--milaura-spacing-sm, 10px);
    /* Ombre port√©e pour lisibilit√© */
    text-shadow:
      0 1px 2px rgba(0,0,0,0.4),
      0 2px 6px rgba(0,0,0,0.3);
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-title-script {
    font-family: var(--milaura-font-script, 'Dancing Script', cursive);
    font-size: 4rem;
    font-weight: 650;
    color: #ffffff;
    line-height: 1.08;
    margin: 0;
    /* Ombre port√©e renforc√©e pour le titre principal */
    text-shadow:
      0 2px 4px rgba(0,0,0,0.45),
      0 4px 12px rgba(0,0,0,0.35),
      0 6px 20px rgba(0,0,0,0.25);
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-subtitle {
    font-family: var(--milaura-font-body);
    font-size: 1.08rem;
    color: rgba(255, 255, 255, 0.98);
    line-height: 1.6;
    max-width: 800px;
    margin: var(--milaura-spacing-sm, 10px) auto 0 auto;
    text-align: center;
    /* Ombre port√©e pour lisibilit√© du sous-titre */
    text-shadow:
      0 1px 3px rgba(0,0,0,0.4),
      0 2px 8px rgba(0,0,0,0.3);
  }

  /* --- GRILLE --- */
  #MilauraHeroShowcase-{{ section.id }} .hero-main-grid {
    max-width: 1200px;
    margin: var(--milaura-spacing-lg, 32px) auto 0 auto;
    display: grid;
    grid-template-columns: 40% 60%;
    gap: var(--milaura-spacing-lg, 32px);
    align-items: start;
  }

  /* --- ONGLETS GAUCHE (dor√© bijou en bordure, pas ‚Äúplastique plein‚Äù) --- */
  #MilauraHeroShowcase-{{ section.id }} .hero-pillars {
    display: flex;
    flex-direction: column;
    gap: var(--milaura-spacing-sm, 10px);
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-tab {
    display: flex;
    align-items: center;
    gap: var(--milaura-spacing-md, 14px);
    padding: 12px 18px;
    width: 100%;
    text-align: left;
    font-family: inherit;
    cursor: pointer;
    position: relative;
    overflow: hidden;

    border-radius: var(--milaura-radius);
    border: 2px solid transparent;

    /* technique bordure gradient bijou */
    background:
      linear-gradient(#ffffff, #ffffff) padding-box,
      var(--milaura-gold-grad) border-box;

    box-shadow:
      0 10px 28px rgba(0,0,0,0.06),
      0 0 0 1px rgba(255,255,255,0.65) inset;

    transition: transform 220ms ease, box-shadow 260ms ease, background 260ms ease;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-tab::after {
    content: '';
    position: absolute;
    inset: 0;
    background: var(--milaura-gold-sheen);
    opacity: 0;
    transform: translateX(-18%);
    transition: opacity 260ms ease, transform 520ms cubic-bezier(0.22, 1, 0.36, 1);
    pointer-events: none;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-tab:hover {
    transform: translateY(-2px);
    box-shadow:
      0 14px 40px rgba(0,0,0,0.10),
      0 0 0 1px rgba(255,255,255,0.75) inset,
      0 0 24px var(--milaura-gold-glow);
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-tab:hover::after {
    opacity: 0.30;
    transform: translateX(18%);
  }

  /* Actif: l√©ger fond dor√© translucide + glow, mais on garde le c√¥t√© ‚Äúbijou‚Äù */
  #MilauraHeroShowcase-{{ section.id }} .hero-tab.is-active {
    background:
      linear-gradient(rgba(255, 248, 225, 0.92), rgba(255, 248, 225, 0.92)) padding-box,
      var(--milaura-gold-grad) border-box;

    box-shadow:
      0 16px 46px rgba(0,0,0,0.12),
      0 0 0 1px rgba(255,255,255,0.55) inset,
      0 0 34px var(--milaura-gold-glow);

    transform: translateY(-1px);
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-pillar-icon {
    font-size: 2rem;
    line-height: 1;
    flex-shrink: 0;
    filter: drop-shadow(0 2px 6px rgba(0, 0, 0, 0.08));
    transition: transform 240ms ease;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-tab:hover .hero-pillar-icon {
    transform: scale(1.06);
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-pillar-title {
    font-family: var(--milaura-font-heading);
    font-size: 1.22rem;
    font-weight: 780;
    color: var(--milaura-text);
    margin-bottom: 4px;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-pillar-text {
    font-family: var(--milaura-font-body);
    font-size: 0.98rem;
    color: var(--milaura-text-light);
    line-height: 1.45;
  }

  /* --- CARROUSEL DROITE + TRANSITIONS SMOOTH --- */
  #MilauraHeroShowcase-{{ section.id }} .hero-carousel-wrapper {
    position: relative;
    border-radius: var(--milaura-radius);
    overflow: visible;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-carousel-frame {
    position: relative;
    border: 2px solid rgba(214, 176, 96, 0.55);
    border-radius: var(--milaura-radius);
    padding: 10px;
    background: rgba(255, 255, 255, 0.14);
    backdrop-filter: blur(10px);
    box-shadow: var(--milaura-shadow-md);
    transform: translate(0px, 8px);
    margin-right: 8px;
    margin-bottom: 8px;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-carousel {
    position: relative;
    width: 100%;
    aspect-ratio: 4 / 3;
    border-radius: calc(var(--milaura-radius) - 6px);
    overflow: hidden;
    background: var(--milaura-beige);
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-slide {
    position: absolute;
    inset: 0;
    opacity: 0;
    pointer-events: none;

    transform: scale(1.015);
    transition:
      opacity 520ms cubic-bezier(0.22, 1, 0.36, 1),
      transform 650ms cubic-bezier(0.22, 1, 0.36, 1);

    will-change: opacity, transform;
    border-radius: calc(var(--milaura-radius) - 6px);
    overflow: hidden;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-slide.is-active {
    opacity: 1;
    pointer-events: auto;
    transform: scale(1);
    z-index: 2;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-slide img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: calc(var(--milaura-radius) - 6px);
    display: block;
    transform: translateZ(0);
  }

  /* CTA sous la photo */
  #MilauraHeroShowcase-{{ section.id }} .hero-cta-row {
    display: flex;
    justify-content: center;
    margin-top: 14px;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-cta-main {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 10px;

    padding: 12px 18px;
    border-radius: 999px;
    border: 1px solid rgba(214, 176, 96, 0.55);

    background: var(--milaura-gold-grad);
    color: #fff;
    text-decoration: none;
    font-weight: 750;
    letter-spacing: 0.2px;

    box-shadow:
      0 18px 40px rgba(130, 90, 30, 0.18),
      0 0 0 1px rgba(255,255,255,0.25) inset;

    position: relative;
    overflow: hidden;

    transition: transform 180ms ease, box-shadow 220ms ease, filter 220ms ease;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-cta-main::after {
    content: '';
    position: absolute;
    inset: -40% -60%;
    background: var(--milaura-gold-sheen);
    opacity: 0;
    transform: translateX(-18%);
    transition: opacity 260ms ease, transform 520ms cubic-bezier(0.22, 1, 0.36, 1);
    pointer-events: none;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-cta-main:hover {
    transform: translateY(-1px);
    box-shadow:
      0 22px 50px rgba(130, 90, 30, 0.22),
      0 0 0 1px rgba(255,255,255,0.30) inset,
      0 0 30px var(--milaura-gold-glow);
    filter: saturate(1.05);
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-cta-main:hover::after {
    opacity: 0.38;
    transform: translateX(18%);
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-cta-main.is-hidden {
    display: none;
  }

  /* --- MOBILE --- */
  @media screen and (max-width: 768px) {
    #MilauraHeroShowcase-{{ section.id }} {
      padding-top: var(--header-height-offset, 40px);
      padding-bottom: var(--milaura-spacing-md, 18px);
      margin-top: var(--milaura-spacing-sm, 10px);
      margin-bottom: var(--milaura-spacing-md, 18px);
    }

    /* Bandeau r√©duit et optimis√© pour mobile */
    #MilauraHeroShowcase-{{ section.id }} .hero-banner-wrap {
      margin-bottom: var(--milaura-spacing-md, 18px);
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-banner {
      padding: 12px 16px;
      border-radius: 20px;
      margin-bottom: var(--milaura-spacing-md, 18px);
      gap: 6px;
    }

    /* logo chapeau mobile: m√™me position mais plus petit */
    #MilauraHeroShowcase-{{ section.id }} .hero-banner-logo {
      top: -12px;
      right: -20px;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-banner-logo img {
      width: 65px;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-kicker {
      font-size: 0.75rem;
      letter-spacing: 1.5px;
      margin-bottom: 4px;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-title-script {
      font-size: 2rem;
      line-height: 1.1;
      margin: 0;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-subtitle {
      font-size: 0.85rem;
      line-height: 1.5;
      margin-top: 6px;
    }

    /* Grille mobile optimis√©e - carousel en premier */
    #MilauraHeroShowcase-{{ section.id }} .hero-main-grid {
      display: flex;
      flex-direction: column;
      gap: var(--milaura-spacing-md, 18px);
      margin: 0;
      padding: 0;
    }

    /* Carousel visible et bien dimensionn√© - PRIORIT√â MOBILE */
    #MilauraHeroShowcase-{{ section.id }} .hero-carousel-wrapper {
      order: 1;
      width: 100%;
      margin: 0;
      padding: 0;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-carousel-frame {
      transform: none;
      margin: 0;
      padding: 8px;
      border-radius: 18px;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-carousel {
      aspect-ratio: 4 / 5;
      min-height: 300px;
      width: 100%;
      display: block;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-slide {
      display: block;
      width: 100%;
      height: 100%;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-slide img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    /* CTA retir√© du carousel sur mobile (d√©j√† dans les piliers) */
    #MilauraHeroShowcase-{{ section.id }} .hero-carousel-wrapper .hero-cta-row {
      display: none;
    }

    /* Piliers en dessous du carousel */
    #MilauraHeroShowcase-{{ section.id }} .hero-pillars {
      order: 2;
      width: 100%;
      gap: var(--milaura-spacing-sm, 10px);
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-tab {
      padding: 10px 14px;
      gap: 12px;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-pillar-icon {
      font-size: 1.6rem;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-pillar-title {
      font-size: 1.1rem;
      margin-bottom: 3px;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-pillar-text {
      font-size: 0.9rem;
      line-height: 1.4;
    }

    /* CTA dans les piliers - optimis√© mobile */
    #MilauraHeroShowcase-{{ section.id }} .hero-pillars .hero-cta-row {
      margin-top: var(--milaura-spacing-sm, 10px);
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-pillars .hero-cta-main {
      width: 100%;
      padding: 14px 20px;
      font-size: 0.95rem;
    }
  }
{% endstyle %}

<div id="MilauraHeroShowcase-{{ section.id }}">
  <div class="hero-card milaura-section-card">
    <div class="hero-header">
      <div class="hero-banner-wrap">
        {% if section.settings.showcase_logo != blank %}
          <div class="hero-banner-logo">
            {{ section.settings.showcase_logo | image_url: width: 360 | image_tag: alt: shop.name }}
          </div>
        {% elsif settings.logo != blank %}
          <div class="hero-banner-logo">
            {{ settings.logo | image_url: width: 360 | image_tag: alt: shop.name }}
          </div>
        {% endif %}

        <div class="hero-banner">
          <div class="hero-banner-text">
            {% if section.settings.kicker != blank %}
              <div class="hero-kicker">{{ section.settings.kicker }}</div>
            {% endif %}

            {% if section.settings.title != blank %}
              <h1 class="hero-title-script">{{ section.settings.title }}</h1>
            {% endif %}

            {% if section.settings.subtitle != blank %}
              <p class="hero-subtitle milaura-text">{{ section.settings.subtitle }}</p>
            {% endif %}
          </div>
        </div>
      </div>
    </div>

    <div class="hero-main-grid">
      <div class="hero-pillars" role="tablist" aria-label="S√©lectionner un univers">
        {% assign tab_index = 0 %}
        {% for block in section.blocks %}
          {% if block.type == 'universe' %}
            <button
              type="button"
              class="hero-tab {% if tab_index == 0 %}is-active{% endif %}"
              data-index="{{ tab_index }}"
              data-cta-label="{{ block.settings.cta_label | escape }}"
              data-cta-link="{{ block.settings.cta_link }}"
              role="tab"
              aria-selected="{% if tab_index == 0 %}true{% else %}false{% endif %}"
              aria-controls="hero-slide-{{ section.id }}-{{ tab_index }}"
              id="hero-tab-{{ section.id }}-{{ tab_index }}"
              {{ block.shopify_attributes }}
            >
              {% if block.settings.icon != blank %}
                <div class="hero-pillar-icon">{{ block.settings.icon }}</div>
              {% endif %}
              <div class="hero-pillar-content">
                {% if block.settings.tab_label != blank %}
                  <div class="hero-pillar-title">{{ block.settings.tab_label }}</div>
                {% elsif block.settings.title != blank %}
                  <div class="hero-pillar-title">{{ block.settings.title }}</div>
                {% endif %}
                {% if block.settings.text != blank %}
                  <div class="hero-pillar-text milaura-text">{{ block.settings.text }}</div>
                {% endif %}
              </div>
            </button>
            {% assign tab_index = tab_index | plus: 1 %}
          {% endif %}
        {% endfor %}

        <div class="hero-cta-row">
          <a href="#" class="hero-cta-main" data-hero-cta> D√©couvrir </a>
        </div>
      </div>

      <div class="hero-carousel-wrapper">
        <div class="hero-carousel-frame">
          <div class="hero-carousel" id="hero-carousel-{{ section.id }}">
            {% assign slide_index = 0 %}
            {% for block in section.blocks %}
              {% if block.type == 'universe' and block.settings.image != blank %}
                <div
                  class="hero-slide {% if slide_index == 0 %}is-active{% endif %}"
                  id="hero-slide-{{ section.id }}-{{ slide_index }}"
                  data-index="{{ slide_index }}"
                  role="tabpanel"
                  aria-labelledby="hero-tab-{{ section.id }}-{{ slide_index }}"
                  aria-hidden="{% if slide_index == 0 %}false{% else %}true{% endif %}"
                  {{ block.shopify_attributes }}
                >
                  {{
                    block.settings.image
                    | image_url: width: 1400
                    | image_tag: loading: 'eager', alt: block.settings.image.alt
                    | default: block.settings.title
                    | default: 'Milaura'
                  }}
                </div>
                {% assign slide_index = slide_index | plus: 1 %}
              {% endif %}
            {% endfor %}

            {% assign universe_blocks = section.blocks | where: 'type', 'universe' %}
            {% if universe_blocks.size == 0 %}
              <div class="hero-slide is-active" role="tabpanel" aria-hidden="false">
                {{ 'image' | placeholder_svg_tag: 'hero-placeholder' }}
              </div>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  (function () {
    const sectionId = '{{ section.id }}';
    const root = document.getElementById('MilauraHeroShowcase-' + sectionId);
    if (!root) return;

    const tabs = Array.from(root.querySelectorAll('.hero-tab[data-index]'));
    const slides = Array.from(root.querySelectorAll('.hero-slide[data-index]'));
    const pillars = root.querySelector('.hero-pillars');
    const carousel = root.querySelector('.hero-carousel');
    const cta = root.querySelector('[data-hero-cta]');

    if (!tabs.length || !slides.length) return;

    const reducedMotion = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;

    // Assure index align√©
    const max = Math.min(tabs.length, slides.length);
    let currentIndex = 0;
    let autoplay = null;
    let resumeTimeout = null;

    const autoplayDuration = 3800; // plus doux qu'un 3000ms trop nerveux
    const resumeDelay = 9000;

    function updateCTA(index) {
      if (!cta) return;
      const tab = tabs[index];
      if (!tab) return;

      const label = (tab.getAttribute('data-cta-label') || '').trim();
      const link = (tab.getAttribute('data-cta-link') || '').trim();

      if (!label || !link || link === '#') {
        cta.classList.add('is-hidden');
        cta.setAttribute('href', '#');
        cta.textContent = 'D√©couvrir';
        return;
      }

      cta.classList.remove('is-hidden');
      cta.setAttribute('href', link);
      cta.textContent = label;
    }

    function setActive(nextIndex) {
      if (nextIndex === currentIndex) return;
      if (nextIndex < 0 || nextIndex >= max) return;

      const prevTab = tabs[currentIndex];
      const nextTab = tabs[nextIndex];
      const prevSlide = slides[currentIndex];
      const nextSlide = slides[nextIndex];

      if (prevTab) {
        prevTab.classList.remove('is-active');
        prevTab.setAttribute('aria-selected', 'false');
      }
      if (prevSlide) {
        prevSlide.classList.remove('is-active');
        prevSlide.setAttribute('aria-hidden', 'true');
      }

      if (nextTab) {
        nextTab.classList.add('is-active');
        nextTab.setAttribute('aria-selected', 'true');
      }
      if (nextSlide) {
        nextSlide.classList.add('is-active');
        nextSlide.setAttribute('aria-hidden', 'false');
      }

      currentIndex = nextIndex;
      updateCTA(currentIndex);
    }

    function goto(index) {
      window.requestAnimationFrame(function () {
        setActive(index);
      });
    }

    function next() {
      const n = (currentIndex + 1) % max;
      goto(n);
    }

    function stopAutoplay() {
      if (autoplay) {
        clearInterval(autoplay);
        autoplay = null;
      }
    }

    function startAutoplay() {
      if (reducedMotion) return;
      stopAutoplay();
      autoplay = setInterval(next, autoplayDuration);
    }

    function scheduleResume() {
      if (reducedMotion) return;
      if (resumeTimeout) clearTimeout(resumeTimeout);
      resumeTimeout = setTimeout(startAutoplay, resumeDelay);
    }

    tabs.slice(0, max).forEach((tab) => {
      tab.addEventListener('click', function (e) {
        e.preventDefault();
        stopAutoplay();
        const idx = parseInt(this.getAttribute('data-index'), 10);
        if (!isNaN(idx)) goto(idx);
        scheduleResume();
      });

      tab.addEventListener('keydown', function (e) {
        let idx = currentIndex;
        if (e.key === 'ArrowRight' || e.key === 'ArrowDown') idx = (currentIndex + 1) % max;
        if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') idx = (currentIndex - 1 + max) % max;
        if (e.key === 'Home') idx = 0;
        if (e.key === 'End') idx = max - 1;

        if (idx !== currentIndex) {
          e.preventDefault();
          stopAutoplay();
          goto(idx);
          tabs[idx].focus();
          scheduleResume();
        }
      });

      tab.addEventListener('focus', function () {
        stopAutoplay();
        scheduleResume();
      });
    });

    if (pillars) {
      pillars.addEventListener('mouseenter', stopAutoplay);
      pillars.addEventListener('mouseleave', startAutoplay);
    }
    if (carousel) {
      carousel.addEventListener('mouseenter', stopAutoplay);
      carousel.addEventListener('mouseleave', startAutoplay);
    }

    root.addEventListener('focusin', function () {
      stopAutoplay();
      scheduleResume();
    });

    // init
    updateCTA(0);
    if (!reducedMotion) startAutoplay();
  })();
</script>

{% schema %}
{
  "name": "Milaura Hero Showcase",
  "tag": "section",
  "class": "section",
  "enabled_on": {
    "templates": ["*"]
  },
  "settings": [
    { "type": "header", "content": "Logo" },
    {
      "type": "image_picker",
      "id": "showcase_logo",
      "label": "Logo du showcase (optionnel, sinon logo du th√®me)"
    },
    { "type": "header", "content": "Header" },
    { "type": "text", "id": "kicker", "label": "Kicker (Sur-titre)", "default": "D√©couvrez" },
    { "type": "text", "id": "title", "label": "Titre principal", "default": "Votre univers √©nerg√©tique" },
    {
      "type": "textarea",
      "id": "subtitle",
      "label": "Sous-titre descriptif",
      "default": "Pierres pr√©cieuses, bijoux uniques et rituels pour √©lever votre √©nergie"
    },

    { "type": "header", "content": "Legacy (non utilis√© si tu passes par les blocs)" },
    { "type": "text", "id": "pillar_1_icon", "label": "Pilier 1 ic√¥ne", "default": "üíé" },
    { "type": "text", "id": "pillar_1_title", "label": "Pilier 1 titre", "default": "Pierres & cristaux" },
    {
      "type": "textarea",
      "id": "pillar_1_text",
      "label": "Pilier 1 texte",
      "default": "S√©lection de pierres naturelles de haute qualit√©, choisies √† la main."
    },
    { "type": "url", "id": "pillar_1_link", "label": "Pilier 1 lien" },

    { "type": "text", "id": "pillar_2_icon", "label": "Pilier 2 ic√¥ne", "default": "‚ú®" },
    { "type": "text", "id": "pillar_2_title", "label": "Pilier 2 titre", "default": "Bijoux artisanaux" },
    {
      "type": "textarea",
      "id": "pillar_2_text",
      "label": "Pilier 2 texte",
      "default": "Cr√©ations artisanales uniques, charg√©es d'intention et d'√©nergie."
    },
    { "type": "url", "id": "pillar_2_link", "label": "Pilier 2 lien" },

    { "type": "text", "id": "pillar_3_icon", "label": "Pilier 3 ic√¥ne", "default": "üïØÔ∏è" },
    { "type": "text", "id": "pillar_3_title", "label": "Pilier 3 titre", "default": "Rituels & bougies" },
    {
      "type": "textarea",
      "id": "pillar_3_text",
      "label": "Pilier 3 texte",
      "default": "Exp√©riences √©nerg√©tiques pour transformer votre espace et votre bien-√™tre."
    },
    { "type": "url", "id": "pillar_3_link", "label": "Pilier 3 lien" }
  ],
  "blocks": [
    {
      "type": "universe",
      "name": "Univers",
      "limit": 10,
      "settings": [
        { "type": "header", "content": "Onglet" },
        { "type": "text", "id": "tab_label", "label": "Label onglet", "default": "Pierres & cristaux" },
        { "type": "text", "id": "icon", "label": "Ic√¥ne (Emoji)", "default": "üíé" },

        { "type": "header", "content": "Contenu" },
        { "type": "text", "id": "title", "label": "Titre court", "default": "Pierres & cristaux" },
        {
          "type": "textarea",
          "id": "text",
          "label": "Texte descriptif",
          "default": "S√©lection de pierres naturelles de haute qualit√©, choisies √† la main."
        },

        { "type": "header", "content": "Slide" },
        { "type": "image_picker", "id": "image", "label": "Image de la slide" },

        { "type": "header", "content": "CTA" },
        { "type": "text", "id": "cta_label", "label": "Texte du bouton", "default": "D√©couvrir" },
        { "type": "url", "id": "cta_link", "label": "Lien du bouton" }
      ]
    }
  ],
  "presets": [
    {
      "name": "Milaura Hero Showcase",
      "blocks": [
        {
          "type": "universe",
          "settings": {
            "tab_label": "Pierres & cristaux",
            "icon": "üíé",
            "title": "Pierres & cristaux",
            "text": "S√©lection de pierres naturelles de haute qualit√©, choisies √† la main.",
            "cta_label": "D√©couvrir"
          }
        },
        {
          "type": "universe",
          "settings": {
            "tab_label": "Bijoux artisanaux",
            "icon": "‚ú®",
            "title": "Bijoux artisanaux",
            "text": "Cr√©ations artisanales uniques, charg√©es d'intention et d'√©nergie.",
            "cta_label": "D√©couvrir"
          }
        },
        {
          "type": "universe",
          "settings": {
            "tab_label": "Rituels & bougies",
            "icon": "üïØÔ∏è",
            "title": "Rituels & bougies",
            "text": "Exp√©riences √©nerg√©tiques pour transformer votre espace et votre bien-√™tre.",
            "cta_label": "D√©couvrir"
          }
        }
      ]
    }
  ]
}
{% endschema %}
