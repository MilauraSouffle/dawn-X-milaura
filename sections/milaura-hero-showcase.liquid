{% style %}
  /* ============================================
     MILAURA HERO SHOWCASE
     4 onglets + dots navigation + responsive tablette
     ============================================ */

  #MilauraHeroShowcase-{{ section.id }} {
    width: 100%;
    padding-top: 0; /* Géré par la règle globale #MainContent > section:first-child */
    padding-bottom: var(--milaura-spacing-lg, 32px);
    background: transparent;
    margin-top: 0;
    margin-bottom: var(--milaura-spacing-lg, 32px);

    /* Fallbacks sûrs (même si base.css n'a pas tes variables) */
    --milaura-radius: var(--milaura-border-radius, 18px);
    --milaura-text: var(--milaura-text, #1b1b1b);
    --milaura-text-light: var(--milaura-text-light, rgba(27, 27, 27, 0.72));
    --milaura-beige: var(--milaura-beige, #f7f3ea);
    --milaura-shadow-md: var(--milaura-shadow-md, 0 18px 45px rgba(0,0,0,0.08));
    --milaura-font-heading: var(--milaura-font-heading, inherit);
    --milaura-font-body: var(--milaura-font-body, inherit);

    /* Doré "bijou" interne à la section (pas dépendant du global) */
    --milaura-gold-ink: #2a1c07;
    --milaura-gold-a: 0.92;

    --milaura-gold-grad: linear-gradient(
      135deg,
      rgba(255, 240, 200, var(--milaura-gold-a)) 0%,
      rgba(214, 176, 96, var(--milaura-gold-a)) 18%,
      rgba(255, 232, 172, var(--milaura-gold-a)) 42%,
      rgba(176, 130, 48, var(--milaura-gold-a)) 70%,
      rgba(255, 240, 200, var(--milaura-gold-a)) 100%
    );

    --milaura-gold-sheen: linear-gradient(
      120deg,
      transparent 0%,
      rgba(255, 255, 255, 0.50) 35%,
      transparent 70%
    );

    --milaura-gold-border: rgba(214, 176, 96, 0.75);
    --milaura-gold-glow: rgba(214, 176, 96, 0.28);
  }

  /* Préférences accessibilité */
  @media (prefers-reduced-motion: reduce) {
    #MilauraHeroShowcase-{{ section.id }} * {
      transition: none !important;
      animation: none !important;
      scroll-behavior: auto !important;
    }
  }

  /* --- CONTENEUR --- */
  #MilauraHeroShowcase-{{ section.id }} .hero-card {
    position: relative;
  }

  /* --- HEADER --- */
  #MilauraHeroShowcase-{{ section.id }} .hero-header {
    text-align: center;
    margin-bottom: var(--milaura-spacing-md, 18px);
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-banner-wrap {
    position: relative;
    max-width: 960px;
    margin: 0 auto var(--milaura-spacing-md, 18px) auto;
  }

  /* --- BANDEAU DORÉ (bijou) --- */
  #MilauraHeroShowcase-{{ section.id }} .hero-banner {
    position: relative;
    z-index: 2;
    overflow: hidden;

    display: flex;
    flex-direction: column;
    align-items: center;
    gap: var(--milaura-spacing-sm, 10px);
    padding: 22px 32px;
    border-radius: 32px;

    background: var(--milaura-gold-grad);
    box-shadow:
      0 20px 55px rgba(130, 90, 30, 0.22),
      0 0 0 1px rgba(255, 255, 255, 0.32) inset,
      0 0 0 1px rgba(214, 176, 96, 0.22);

    color: #fff;
  }

  /* Voile lumineux subtil (statique), et sheen au hover (pas en boucle, donc pas de lag) */
  #MilauraHeroShowcase-{{ section.id }} .hero-banner::before {
    content: '';
    position: absolute;
    inset: 0;
    background: radial-gradient(1200px 300px at 20% 0%, rgba(255,255,255,0.22), transparent 55%);
    opacity: 0.85;
    pointer-events: none;
    z-index: 1;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-banner::after {
    content: '';
    position: absolute;
    inset: -40% -60%;
    background: var(--milaura-gold-sheen);
    opacity: 0;
    transform: translateX(-18%);
    transition: opacity 380ms ease, transform 600ms cubic-bezier(0.22, 1, 0.36, 1);
    pointer-events: none;
    z-index: 1;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-banner:hover::after {
    opacity: 0.35;
    transform: translateX(18%);
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-banner-text {
    position: relative;
    z-index: 2;
  }

  /* --- LOGO "chapeau" (corrigé: px + intégration douce) --- */
  #MilauraHeroShowcase-{{ section.id }} .hero-banner-logo {
    position: absolute;
    top: -30px;
    right: -30px;
    z-index: 3;
    pointer-events: none;
    opacity: 0.92;
    filter: saturate(1.05);
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-banner-logo img {
    display: block;
    width: 140px;
    height: auto;
    filter: drop-shadow(0 12px 28px rgba(0, 0, 0, 0.22));
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-kicker {
    font-family: var(--milaura-font-body);
    font-size: {{ section.settings.kicker_size }}px;
    text-transform: uppercase;
    letter-spacing: 2px;
    color: {{ section.settings.kicker_color }};
    font-weight: 650;
    margin-bottom: var(--milaura-spacing-sm, 10px);
    {% if section.settings.kicker_stroke_enabled %}
    -webkit-text-stroke: {{ section.settings.kicker_stroke_width }}px {{ section.settings.kicker_stroke_color }};
    paint-order: stroke fill;
    {% endif %}
  }

  /* --- BULLE GLASSMORPHISM TITRE --- */
  #MilauraHeroShowcase-{{ section.id }} .hero-title-wrap {
    position: relative;
    display: inline-block;
    padding: 0;
  }

  {% if section.settings.title_bubble_enabled %}
  #MilauraHeroShowcase-{{ section.id }} .hero-title-wrap::before {
    content: '';
    position: absolute;
    inset: -12px -28px;
    border-radius: 50px;
    background: {{ section.settings.title_bubble_color }};
    opacity: {{ section.settings.title_bubble_opacity | divided_by: 100.0 }};
    backdrop-filter: blur({{ section.settings.title_bubble_blur }}px);
    -webkit-backdrop-filter: blur({{ section.settings.title_bubble_blur }}px);
    border: 1px solid rgba(255, 255, 255, 0.25);
    box-shadow:
      0 8px 32px rgba(0, 0, 0, 0.08),
      inset 0 1px 0 rgba(255, 255, 255, 0.35);
    z-index: -1;
    pointer-events: none;
  }

  /* Reflet subtil en haut de la bulle */
  #MilauraHeroShowcase-{{ section.id }} .hero-title-wrap::after {
    content: '';
    position: absolute;
    top: -10px;
    left: 50%;
    transform: translateX(-50%);
    width: 60%;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.5), transparent);
    border-radius: 50%;
    z-index: 0;
    pointer-events: none;
  }
  {% endif %}

  #MilauraHeroShowcase-{{ section.id }} .hero-title-script {
    position: relative;
    z-index: 1;
    font-family: {{ section.settings.title_font }};
    font-size: {{ section.settings.title_size | divided_by: 10.0 }}rem;
    font-weight: 650;
    color: {{ section.settings.banner_text_color }};
    line-height: 1.08;
    margin: 0;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-subtitle {
    font-family: var(--milaura-font-body);
    font-size: {{ section.settings.subtitle_size }}px;
    color: {{ section.settings.subtitle_color }};
    line-height: 1.6;
    max-width: 800px;
    margin: var(--milaura-spacing-sm, 10px) auto 0 auto;
    text-align: center;
    {% if section.settings.subtitle_stroke_enabled %}
    -webkit-text-stroke: {{ section.settings.subtitle_stroke_width }}px {{ section.settings.subtitle_stroke_color }};
    paint-order: stroke fill;
    {% endif %}
  }

  /* --- GRILLE --- */
  #MilauraHeroShowcase-{{ section.id }} .hero-main-grid {
    max-width: 1200px;
    margin: var(--milaura-spacing-lg, 32px) auto 0 auto;
    display: grid;
    grid-template-columns: 40% 60%;
    gap: var(--milaura-spacing-lg, 32px);
    align-items: stretch;
  }

  /* --- ONGLETS GAUCHE (doré bijou en bordure, pas "plastique plein") --- */
  #MilauraHeroShowcase-{{ section.id }} .hero-pillars {
    display: flex;
    flex-direction: column;
    gap: var(--milaura-spacing-sm, 10px);
    padding-top: 18px; /* Alignement avec le slide (frame décalé de 8px + padding 10px) */
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-tab {
    display: flex;
    align-items: center;
    gap: var(--milaura-spacing-md, 14px);
    padding: 12px 18px;
    width: 100%;
    text-align: left;
    font-family: inherit;
    cursor: pointer;
    position: relative;
    overflow: hidden;

    border-radius: var(--milaura-radius);
    border: 2px solid transparent;

    /* technique bordure gradient bijou */
    background:
      linear-gradient(#ffffff, #ffffff) padding-box,
      var(--milaura-gold-grad) border-box;

    box-shadow:
      0 10px 28px rgba(0,0,0,0.06),
      0 0 0 1px rgba(255,255,255,0.65) inset;

    transition: transform 220ms ease, box-shadow 260ms ease, background 260ms ease, max-height 400ms cubic-bezier(0.22, 1, 0.36, 1);
  }

  /* Mode expandable - structure en colonnes */
  {% if section.settings.expandable_pillars %}
  #MilauraHeroShowcase-{{ section.id }} .hero-tab {
    flex-direction: column;
    align-items: stretch;
  }

  /* Wrapper pour icon + titre (toujours centré horizontalement) */
  #MilauraHeroShowcase-{{ section.id }} .hero-pillar-header {
    display: flex;
    align-items: center;
    gap: var(--milaura-spacing-md, 14px);
    width: 100%;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-pillar-content {
    flex: 1;
  }
  {% endif %}

  #MilauraHeroShowcase-{{ section.id }} .hero-tab::after {
    content: '';
    position: absolute;
    inset: 0;
    background: var(--milaura-gold-sheen);
    opacity: 0;
    transform: translateX(-18%);
    transition: opacity 260ms ease, transform 520ms cubic-bezier(0.22, 1, 0.36, 1);
    pointer-events: none;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-tab:hover {
    transform: translateY(-2px);
    box-shadow:
      0 14px 40px rgba(0,0,0,0.10),
      0 0 0 1px rgba(255,255,255,0.75) inset,
      0 0 24px var(--milaura-gold-glow);
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-tab:hover::after {
    opacity: 0.30;
    transform: translateX(18%);
  }

  /* Actif: léger fond doré translucide + glow, mais on garde le côté "bijou" */
  #MilauraHeroShowcase-{{ section.id }} .hero-tab.is-active {
    background:
      linear-gradient(rgba(255, 248, 225, 0.92), rgba(255, 248, 225, 0.92)) padding-box,
      var(--milaura-gold-grad) border-box;

    box-shadow:
      0 16px 46px rgba(0,0,0,0.12),
      0 0 0 1px rgba(255,255,255,0.55) inset,
      0 0 34px var(--milaura-gold-glow);

    transform: translateY(-1px);
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-pillar-icon {
    font-size: 2rem;
    line-height: 1;
    flex-shrink: 0;
    filter: drop-shadow(0 2px 6px rgba(0, 0, 0, 0.08));
    transition: transform 240ms ease;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-tab:hover .hero-pillar-icon {
    transform: scale(1.06);
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-pillar-title {
    font-family: var(--milaura-font-heading);
    font-size: 1.6rem;
    font-weight: 780;
    color: {{ section.settings.tab_title_color }};
    margin-bottom: 0;
  }

  /* Sous-titres piliers cachés sur desktop pour un look plus épuré */
  #MilauraHeroShowcase-{{ section.id }} .hero-pillar-text {
    display: none;
  }

  /* ============================================
     MODE PILIERS EXPANSIBLES - PREMIUM
     ============================================ */
  {% if section.settings.expandable_pillars %}

  /* Zone expandable - complètement cachée par défaut */
  #MilauraHeroShowcase-{{ section.id }} .hero-pillar-expand {
    display: none;
    width: 100%;
    flex-direction: column;
    gap: 14px;
    margin-top: 14px;
    padding-top: 14px;
    border-top: 1px solid rgba(192, 160, 98, 0.15);
    animation: pillarExpandIn 400ms cubic-bezier(0.22, 1, 0.36, 1) forwards;
  }

  @keyframes pillarExpandIn {
    from {
      opacity: 0;
      transform: translateY(-8px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* État expanded - afficher la zone */
  #MilauraHeroShowcase-{{ section.id }} .hero-tab.is-expanded .hero-pillar-expand {
    display: flex;
  }

  /* État expanded du pilier - Design PREMIUM doré */
  #MilauraHeroShowcase-{{ section.id }} .hero-tab.is-expanded {
    background:
      linear-gradient(
        135deg,
        rgba(255, 250, 240, 0.97) 0%,
        rgba(255, 245, 230, 0.95) 50%,
        rgba(255, 248, 235, 0.97) 100%
      ) padding-box,
      linear-gradient(
        135deg,
        rgba(214, 176, 96, 0.9) 0%,
        rgba(192, 160, 98, 1) 25%,
        rgba(230, 200, 139, 0.95) 50%,
        rgba(192, 160, 98, 1) 75%,
        rgba(214, 176, 96, 0.9) 100%
      ) border-box;
    border-width: 2px;
    box-shadow:
      0 20px 50px rgba(192, 160, 98, 0.25),
      0 8px 25px rgba(0, 0, 0, 0.08),
      0 0 0 1px rgba(255, 255, 255, 0.6) inset,
      inset 0 1px 0 rgba(255, 255, 255, 0.8),
      0 0 40px rgba(192, 160, 98, 0.15);
    transform: translateY(-2px);
  }

  /* Reflet lumineux sur expanded */
  #MilauraHeroShowcase-{{ section.id }} .hero-tab.is-expanded::before {
    content: '';
    position: absolute;
    top: 0;
    left: 10%;
    right: 10%;
    height: 1px;
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.9), transparent);
    opacity: 1;
  }

  /* Description longue dans l'expand */
  #MilauraHeroShowcase-{{ section.id }} .hero-pillar-long-desc {
    font-family: var(--milaura-font-body);
    font-size: 0.95rem;
    line-height: 1.55;
    color: #4a4a4a;
    margin: 0;
    padding-left: 2px;
  }

  /* CTA inline dans le pilier - Style bijou raffiné */
  #MilauraHeroShowcase-{{ section.id }} .hero-pillar-cta {
    position: relative;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    padding: 11px 24px;
    border-radius: 50px;
    text-decoration: none;
    font-family: 'Lato', sans-serif;
    font-size: 0.85rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.8px;
    color: #1a1a1a;
    background: var(--milaura-gold-grad);
    border: none;
    box-shadow:
      0 4px 18px rgba(192, 160, 98, 0.45),
      0 0 0 1px rgba(255, 255, 255, 0.3) inset,
      inset 0 1px 0 rgba(255, 255, 255, 0.5);
    transition: transform 0.25s ease, box-shadow 0.25s ease;
    align-self: flex-start;
    overflow: hidden;
  }

  /* Sheen effect sur CTA */
  #MilauraHeroShowcase-{{ section.id }} .hero-pillar-cta::after {
    content: '';
    position: absolute;
    inset: -50%;
    background: linear-gradient(
      120deg,
      transparent 30%,
      rgba(255, 255, 255, 0.4) 50%,
      transparent 70%
    );
    transform: translateX(-100%);
    transition: transform 0.6s ease;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-pillar-cta:hover {
    transform: translateY(-3px);
    box-shadow:
      0 8px 28px rgba(192, 160, 98, 0.5),
      0 0 0 1px rgba(255, 255, 255, 0.4) inset,
      inset 0 1px 0 rgba(255, 255, 255, 0.6);
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-pillar-cta:hover::after {
    transform: translateX(100%);
  }

  /* Indicateur d'expansion - élégant et subtil */
  #MilauraHeroShowcase-{{ section.id }} .hero-pillar-chevron {
    flex-shrink: 0;
    width: 24px;
    height: 24px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    background: linear-gradient(135deg, rgba(192, 160, 98, 0.12) 0%, rgba(192, 160, 98, 0.06) 100%);
    border: 1px solid rgba(192, 160, 98, 0.2);
    transition: all 350ms cubic-bezier(0.22, 1, 0.36, 1);
    font-size: 0;
    margin-left: auto;
  }

  /* Icône + en CSS pur */
  #MilauraHeroShowcase-{{ section.id }} .hero-pillar-chevron::before,
  #MilauraHeroShowcase-{{ section.id }} .hero-pillar-chevron::after {
    content: '';
    position: absolute;
    background: linear-gradient(135deg, #b8956d, #C0A062);
    border-radius: 2px;
    transition: all 350ms cubic-bezier(0.22, 1, 0.36, 1);
  }

  /* Ligne horizontale */
  #MilauraHeroShowcase-{{ section.id }} .hero-pillar-chevron::before {
    width: 10px;
    height: 2px;
  }

  /* Ligne verticale (devient invisible en expanded) */
  #MilauraHeroShowcase-{{ section.id }} .hero-pillar-chevron::after {
    width: 2px;
    height: 10px;
  }

  /* État expanded: + devient - */
  #MilauraHeroShowcase-{{ section.id }} .hero-tab.is-expanded .hero-pillar-chevron {
    background: linear-gradient(135deg, rgba(192, 160, 98, 0.25) 0%, rgba(192, 160, 98, 0.15) 100%);
    border-color: rgba(192, 160, 98, 0.35);
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-tab.is-expanded .hero-pillar-chevron::after {
    height: 0;
    opacity: 0;
  }

  /* Hover sur l'indicateur */
  #MilauraHeroShowcase-{{ section.id }} .hero-tab:hover .hero-pillar-chevron {
    background: linear-gradient(135deg, rgba(192, 160, 98, 0.2) 0%, rgba(192, 160, 98, 0.1) 100%);
    border-color: rgba(192, 160, 98, 0.35);
    box-shadow: 0 2px 8px rgba(192, 160, 98, 0.2);
  }

  {% endif %}

  /* Option: Masquer le CTA principal sous les piliers */
  {% if section.settings.hide_main_cta %}
  #MilauraHeroShowcase-{{ section.id }} .hero-pillars > .hero-cta-row {
    display: none !important;
  }
  {% endif %}

  /* --- CARROUSEL DROITE + TRANSITIONS SMOOTH --- */
  #MilauraHeroShowcase-{{ section.id }} .hero-carousel-wrapper {
    position: relative;
    border-radius: var(--milaura-radius);
    overflow: visible;
    display: flex;
    flex-direction: column;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-carousel-frame {
    position: relative;
    border: 2px solid rgba(214, 176, 96, 0.55);
    border-radius: var(--milaura-radius);
    padding: 10px;
    background: rgba(255, 255, 255, 0.14);
    backdrop-filter: blur(10px);
    box-shadow: var(--milaura-shadow-md);
    transform: translate(0px, 8px);
    margin-right: 8px;
    margin-bottom: 8px;
    flex: 1;
    display: flex;
    flex-direction: column;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-carousel {
    position: relative;
    width: 100%;
    flex: 1;
    min-height: 350px;
    border-radius: calc(var(--milaura-radius) - 6px);
    overflow: hidden;
    background: var(--milaura-beige);
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-slide {
    position: absolute;
    inset: 0;
    opacity: 0;
    pointer-events: none;

    transform: scale(1.015);
    transition:
      opacity 520ms cubic-bezier(0.22, 1, 0.36, 1),
      transform 650ms cubic-bezier(0.22, 1, 0.36, 1);

    will-change: opacity, transform;
    border-radius: calc(var(--milaura-radius) - 6px);
    overflow: hidden;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-slide.is-active {
    opacity: 1;
    pointer-events: auto;
    transform: scale(1);
    z-index: 2;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-slide img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: calc(var(--milaura-radius) - 6px);
    display: block;
    transform: translateZ(0);
  }

  /* CTA sous la photo - layout uniquement */
  #MilauraHeroShowcase-{{ section.id }} .hero-cta-row {
    display: flex;
    justify-content: center;
    margin-top: 14px;
  }

  /* --- CTA QUIZ SECONDAIRE avec bulle glassmorphism --- */
  #MilauraHeroShowcase-{{ section.id }} .hero-quiz-cta-row {
    display: flex;
    justify-content: center;
    margin-top: 16px;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-quiz-bubble {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 12px;
    padding: 18px 28px;
    background: rgba(255, 255, 255, 0.65);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    border-radius: 24px;
    border: 1px solid rgba(192, 160, 98, 0.25);
    box-shadow:
      0 8px 32px rgba(0, 0, 0, 0.06),
      inset 0 1px 0 rgba(255, 255, 255, 0.5);
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-quiz-hint {
    font-family: var(--milaura-font-body);
    font-size: {{ section.settings.quiz_hint_size | default: 1.2 }}rem;
    color: var(--milaura-text-light, #666);
    text-align: center;
    line-height: 1.5;
    max-width: 320px;
  }

  /* Animation halo pulsant pour CTA Quiz */
  @keyframes heroHaloPulse {
    0% {
      box-shadow: 0 0 0 0 rgba(192, 160, 98, 0.6);
    }
    50% {
      box-shadow: 0 0 0 12px rgba(192, 160, 98, 0);
    }
    100% {
      box-shadow: 0 0 0 0 rgba(192, 160, 98, 0);
    }
  }

  @keyframes heroBadgeShimmer {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-quiz-cta {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    padding: 12px 24px;
    border-radius: 50px;
    text-decoration: none;
    font-family: 'Lato', sans-serif;
    font-size: 1.1rem;
    font-weight: 800;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    color: #fff;
    background: linear-gradient(135deg, var(--milaura-gold, #C0A062) 0%, #D4B678 50%, var(--milaura-gold-light, #E6C88B) 100%);
    background-size: 200% 200%;
    border: none;
    box-shadow: 0 4px 20px rgba(192, 160, 98, 0.5);
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    white-space: nowrap;
    position: relative;
    animation: heroBadgeShimmer 3s ease-in-out infinite;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
  }

  /* HALO PULSANT - identique à la navbar */
  #MilauraHeroShowcase-{{ section.id }} .hero-quiz-cta::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    border-radius: 50px;
    box-shadow: 0 0 0 0 rgba(192, 160, 98, 0.6);
    animation: heroHaloPulse 2s ease-out infinite;
    pointer-events: none;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-quiz-cta:hover {
    transform: translateY(-3px) scale(1.02);
    box-shadow: 0 8px 30px rgba(192, 160, 98, 0.6);
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-quiz-cta:hover::before {
    animation: none;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-quiz-cta-text {
    white-space: nowrap;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-cta-main.is-hidden {
    display: none;
  }

  /* Style du CTA principal - bouton Découvrir sous les piliers */
  #MilauraHeroShowcase-{{ section.id }} a.milaura-cta.hero-cta-main {
    color: #000 !important;
    font-size: 1.25rem !important;
    padding: 16px 36px !important;
    letter-spacing: 0.8px;
    font-weight: 700;
    min-width: 200px;
  }

  /* --- INDICATEURS DE SLIDE (DOTS) --- */
  #MilauraHeroShowcase-{{ section.id }} .hero-dots {
    display: flex;
    justify-content: center;
    gap: 8px;
    margin-top: 12px;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: rgba(192, 160, 98, 0.3);
    border: none;
    padding: 0;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-dot:hover {
    background: rgba(192, 160, 98, 0.5);
    transform: scale(1.2);
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-dot.is-active {
    background: var(--milaura-gold, #C0A062);
    transform: scale(1.3);
  }

  /* --- TABLETTE (769px - 1024px) --- */
  @media screen and (min-width: 769px) and (max-width: 1024px) {
    #MilauraHeroShowcase-{{ section.id }} .hero-main-grid {
      grid-template-columns: 35% 65%;
      gap: var(--milaura-spacing-md, 18px);
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-tab {
      padding: 10px 14px;
      gap: 10px;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-pillar-title {
      font-size: 1.15rem;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-pillar-text {
      font-size: 1rem;
      line-height: 1.35;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-pillar-icon {
      font-size: 1.7rem;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-title-script {
      font-size: clamp(2.2rem, 4vw, {{ section.settings.title_size | divided_by: 10.0 }}rem);
    }

    {% if section.settings.title_bubble_enabled %}
    #MilauraHeroShowcase-{{ section.id }} .hero-title-wrap::before {
      inset: -10px -22px;
      border-radius: 40px;
    }
    {% endif %}

    #MilauraHeroShowcase-{{ section.id }} .hero-banner {
      padding: 16px 24px;
    }
  }

  /* --- MOBILE (max 768px) --- */
  @media screen and (max-width: 768px) {
    #MilauraHeroShowcase-{{ section.id }} {
      padding-top: 0; /* Géré par la règle globale */
      padding-bottom: var(--milaura-spacing-md, 18px);
      margin-top: 0;
      margin-bottom: var(--milaura-spacing-md, 18px);
    }

    /* Bandeau réduit et optimisé pour mobile */
    #MilauraHeroShowcase-{{ section.id }} .hero-banner-wrap {
      margin-bottom: var(--milaura-spacing-md, 18px);
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-banner {
      padding: 12px 16px;
      border-radius: 20px;
      margin-bottom: var(--milaura-spacing-md, 18px);
      gap: 6px;
    }

    /* logo chapeau mobile: même position mais plus petit */
    #MilauraHeroShowcase-{{ section.id }} .hero-banner-logo {
      top: -12px;
      right: -20px;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-banner-logo img {
      width: 65px;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-kicker {
      font-size: {{ section.settings.kicker_size_mobile }}px;
      letter-spacing: 1.5px;
      margin-bottom: 4px;
    }

    /* Titre responsive basé sur le setting */
    #MilauraHeroShowcase-{{ section.id }} .hero-title-script {
      font-size: clamp(1.6rem, 6vw, 2.4rem);
      line-height: 1.1;
      margin: 0;
    }

    {% if section.settings.title_bubble_enabled %}
    #MilauraHeroShowcase-{{ section.id }} .hero-title-wrap::before {
      inset: -8px -16px;
      border-radius: 30px;
    }
    {% endif %}

    #MilauraHeroShowcase-{{ section.id }} .hero-subtitle {
      font-size: {{ section.settings.subtitle_size_mobile }}px;
      line-height: 1.45;
      margin-top: 6px;
    }

    /* Grille mobile optimisée - carousel en premier */
    #MilauraHeroShowcase-{{ section.id }} .hero-main-grid {
      display: flex;
      flex-direction: column;
      gap: var(--milaura-spacing-md, 12px);
      margin: 0;
      padding: 0;
    }

    /* Carousel visible et bien dimensionné - PRIORITÉ MOBILE */
    #MilauraHeroShowcase-{{ section.id }} .hero-carousel-wrapper {
      order: 1;
      width: 100%;
      margin: 0;
      padding: 0;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-carousel-frame {
      transform: none;
      margin: 0;
      padding: 6px;
      border-radius: 16px;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-carousel {
      aspect-ratio: 4 / 5;
      min-height: 280px;
      width: 100%;
      display: block;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-slide {
      display: block;
      width: 100%;
      height: 100%;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-slide img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    /* CTA retiré du carousel sur mobile (déjà dans les piliers) */
    #MilauraHeroShowcase-{{ section.id }} .hero-carousel-wrapper .hero-cta-row {
      display: none;
    }

    /* Dots visibles sur mobile */
    #MilauraHeroShowcase-{{ section.id }} .hero-dots {
      margin-top: 10px;
    }

    /* Piliers COMPACTS en dessous du carousel */
    #MilauraHeroShowcase-{{ section.id }} .hero-pillars {
      order: 2;
      width: 100%;
      gap: 8px;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-tab {
      padding: 10px 12px;
      gap: 10px;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-pillar-icon {
      font-size: 1.4rem;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-pillar-title {
      font-size: 1.2rem;
      margin-bottom: 2px;
    }

    /* Description sur mobile - tronquée à 2 lignes */
    #MilauraHeroShowcase-{{ section.id }} .hero-pillar-text {
      font-size: 1.1rem;
      line-height: 1.3;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    {% if section.settings.hide_tab_text_mobile %}
    #MilauraHeroShowcase-{{ section.id }} .hero-pillar-text {
      display: none !important;
    }
    {% endif %}

    /* CTA dans les piliers - optimisé mobile (layout uniquement) */
    #MilauraHeroShowcase-{{ section.id }} .hero-pillars .hero-cta-row {
      margin-top: var(--milaura-spacing-sm, 8px);
    }

    /* Mode expandable sur mobile - PREMIUM */
    {% if section.settings.expandable_pillars %}
    #MilauraHeroShowcase-{{ section.id }} .hero-pillar-chevron {
      width: 22px;
      height: 22px;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-pillar-chevron::before {
      width: 9px;
      height: 1.5px;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-pillar-chevron::after {
      width: 1.5px;
      height: 9px;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-pillar-long-desc {
      font-size: 0.9rem;
      line-height: 1.5;
      color: #555;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-pillar-cta {
      padding: 12px 20px;
      font-size: 0.8rem;
      width: 100%;
      justify-content: center;
      letter-spacing: 0.6px;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-tab.is-expanded .hero-pillar-expand {
      margin-top: 12px;
      padding-top: 12px;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-tab.is-expanded {
      box-shadow:
        0 12px 35px rgba(192, 160, 98, 0.22),
        0 4px 15px rgba(0, 0, 0, 0.06),
        0 0 0 1px rgba(255, 255, 255, 0.5) inset,
        0 0 25px rgba(192, 160, 98, 0.12);
    }
    {% endif %}

    /* Quiz CTA mobile - Premium compact design */
    #MilauraHeroShowcase-{{ section.id }} .hero-quiz-cta-row {
      margin-top: 20px;
      padding: 0 16px;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-quiz-bubble {
      padding: 16px;
      gap: 12px;
      flex-direction: column;
      border-radius: var(--milaura-border-radius);
      background: rgba(255, 255, 255, 0.6);
      backdrop-filter: blur(15px);
      -webkit-backdrop-filter: blur(15px);
      border: 1px solid rgba(192, 160, 98, 0.2);
      box-shadow: var(--milaura-shadow-md);
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-quiz-hint {
      font-family: var(--milaura-font-body);
      font-size: 0.75rem;
      max-width: 220px;
      color: var(--milaura-text-light);
      text-align: center;
      line-height: 1.4;
      font-style: italic;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-quiz-cta {
      width: 100%;
      max-width: 280px;
      padding: 14px 28px;
      font-family: 'Lato', sans-serif;
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      border-radius: 50px;
      background: linear-gradient(135deg, var(--milaura-gold, #C0A062) 0%, #D4B678 50%, var(--milaura-gold-light, #E6C88B) 100%);
      background-size: 200% 200%;
      color: #fff;
      font-weight: 800;
      border: none;
      box-shadow: 0 4px 20px rgba(192, 160, 98, 0.5);
      transition: transform 0.2s ease, box-shadow 0.2s ease;
      text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
      animation: heroBadgeShimmer 3s ease-in-out infinite;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-quiz-cta::before {
      animation: heroHaloPulse 2s ease-out infinite;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-quiz-cta:active {
      transform: scale(0.97);
    }
  }

  /* --- TRÈS PETIT MOBILE (max 380px) --- */
  @media screen and (max-width: 380px) {
    #MilauraHeroShowcase-{{ section.id }} .hero-title-script {
      font-size: 1.5rem;
    }

    {% if section.settings.title_bubble_enabled %}
    #MilauraHeroShowcase-{{ section.id }} .hero-title-wrap::before {
      inset: -6px -12px;
      border-radius: 24px;
    }
    {% endif %}

    #MilauraHeroShowcase-{{ section.id }} .hero-subtitle {
      font-size: 0.9rem;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-tab {
      padding: 8px 10px;
      gap: 8px;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-pillar-icon {
      font-size: 1.2rem;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-pillar-title {
      font-size: 1.1rem;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-pillar-text {
      font-size: 1rem;
      display: -webkit-box;
      -webkit-line-clamp: 1;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
  }

  /* --- TRUST BADGES (intégrés au hero) --- */
  #MilauraHeroShowcase-{{ section.id }} .hero-trust-badges {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: var(--milaura-spacing-sm, 12px);
    margin-top: var(--milaura-spacing-md, 24px);
    padding: 0 var(--milaura-spacing-md, 24px);
    width: 100%;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-trust-badge {
    display: flex;
    align-items: center;
    gap: 8px;
    background: #FFFFFF;
    border: 1px solid var(--milaura-gold, #C0A062);
    padding: var(--milaura-spacing-xs, 6px) var(--milaura-spacing-md, 24px);
    border-radius: 50px;
    box-shadow: var(--milaura-shadow-sm, 0 4px 15px rgba(192, 160, 98, 0.15));
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-trust-badge:hover {
    transform: translateY(-3px);
    border-color: var(--milaura-gold-light, #E6C88B);
    box-shadow: var(--milaura-shadow-md, 0 15px 40px rgba(192, 160, 98, 0.25));
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-trust-badge .badge-icon {
    font-size: 1.1rem;
    line-height: 1;
  }

  #MilauraHeroShowcase-{{ section.id }} .hero-trust-badge .badge-text {
    font-family: var(--milaura-font-body, 'Lato', sans-serif);
    font-size: 13px;
    font-weight: 600;
    color: var(--milaura-text, #1b1b1b);
    text-transform: uppercase;
    letter-spacing: 0.05em;
    white-space: nowrap;
  }

  /* Mobile badges responsive - Premium compact design */
  @media (max-width: 768px) {
    #MilauraHeroShowcase-{{ section.id }} .hero-trust-badges {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      padding: 0 20px;
      margin-top: 16px;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-trust-badge {
      background: rgba(255, 255, 255, 0.5);
      backdrop-filter: blur(10px);
      -webkit-backdrop-filter: blur(10px);
      border: 1px solid rgba(192, 160, 98, 0.25);
      padding: 6px 14px;
      border-radius: 999px;
      box-shadow: var(--milaura-shadow-sm);
      display: flex;
      align-items: center;
      gap: 6px;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-trust-badge .badge-icon {
      font-size: 0.85rem;
      filter: drop-shadow(0 1px 1px rgba(0,0,0,0.05));
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-trust-badge .badge-text {
      font-family: var(--milaura-font-body);
      font-size: 9px;
      white-space: nowrap;
      text-align: left;
      line-height: 1;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      font-weight: 700;
      color: var(--milaura-text);
    }
  }

  /* Très petit mobile */
  @media (max-width: 380px) {
    #MilauraHeroShowcase-{{ section.id }} .hero-trust-badges {
      gap: 8px;
      padding: 0 12px;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-trust-badge {
      padding: 5px 10px;
      gap: 5px;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-trust-badge .badge-icon {
      font-size: 0.75rem;
    }

    #MilauraHeroShowcase-{{ section.id }} .hero-trust-badge .badge-text {
      font-size: 8px;
      letter-spacing: 0.05em;
    }
  }
{% endstyle %}

<div id="MilauraHeroShowcase-{{ section.id }}">
  <div class="hero-card milaura-section-card">
    <div class="hero-header">
      <div class="hero-banner-wrap">
        {% if section.settings.showcase_logo != blank %}
          <div class="hero-banner-logo">
            {{ section.settings.showcase_logo | image_url: width: 360 | image_tag: alt: shop.name }}
          </div>
        {% elsif settings.logo != blank %}
          <div class="hero-banner-logo">
            {{ settings.logo | image_url: width: 360 | image_tag: alt: shop.name }}
          </div>
        {% endif %}

        <div class="hero-banner">
          <div class="hero-banner-text">
            {% if section.settings.kicker != blank %}
              <div class="hero-kicker">{{ section.settings.kicker }}</div>
            {% endif %}

            {% if section.settings.title != blank %}
              <div class="hero-title-wrap">
                <h2 class="hero-title-script">{{ section.settings.title }}</h2>
              </div>
            {% endif %}

            {% if section.settings.subtitle != blank %}
              <p class="hero-subtitle milaura-text">{{ section.settings.subtitle }}</p>
            {% endif %}
          </div>
        </div>
      </div>
    </div>

    <div class="hero-main-grid">
      <div class="hero-pillars" role="tablist" aria-label="Sélectionner un univers">
        {% assign tab_index = 0 %}
        {% for block in section.blocks %}
          {% if block.type == 'universe' %}
            <button
              type="button"
              class="hero-tab {% if tab_index == 0 %}is-active{% endif %}"
              data-index="{{ tab_index }}"
              data-cta-label="{{ block.settings.cta_label | escape }}"
              data-cta-link="{{ block.settings.cta_link }}"
              role="tab"
              aria-selected="{% if tab_index == 0 %}true{% else %}false{% endif %}"
              aria-controls="hero-slide-{{ section.id }}-{{ tab_index }}"
              id="hero-tab-{{ section.id }}-{{ tab_index }}"
              {{ block.shopify_attributes }}
            >
              {%- if section.settings.expandable_pillars -%}
                <div class="hero-pillar-header">
                  {% if block.settings.icon != blank %}
                    <div class="hero-pillar-icon">{{ block.settings.icon }}</div>
                  {% endif %}
                  <div class="hero-pillar-content">
                    {% if block.settings.tab_label != blank %}
                      <div class="hero-pillar-title">{{ block.settings.tab_label }}</div>
                    {% elsif block.settings.title != blank %}
                      <div class="hero-pillar-title">{{ block.settings.title }}</div>
                    {% endif %}
                    {% if block.settings.text != blank %}
                      <div class="hero-pillar-text milaura-text">{{ block.settings.text }}</div>
                    {% endif %}
                  </div>
                  <span class="hero-pillar-chevron" aria-hidden="true"></span>
                </div>
                <div class="hero-pillar-expand">
                  {%- assign long_desc = block.settings.long_description | default: block.settings.text -%}
                  {%- if long_desc != blank -%}
                    <p class="hero-pillar-long-desc">{{ long_desc }}</p>
                  {%- endif -%}
                  {%- if block.settings.cta_link != blank and block.settings.cta_label != blank -%}
                    <a href="{{ block.settings.cta_link }}" class="hero-pillar-cta" onclick="event.stopPropagation();">
                      {{ block.settings.cta_label }}
                    </a>
                  {%- endif -%}
                </div>
              {%- else -%}
                {% if block.settings.icon != blank %}
                  <div class="hero-pillar-icon">{{ block.settings.icon }}</div>
                {% endif %}
                <div class="hero-pillar-content">
                  {% if block.settings.tab_label != blank %}
                    <div class="hero-pillar-title">{{ block.settings.tab_label }}</div>
                  {% elsif block.settings.title != blank %}
                    <div class="hero-pillar-title">{{ block.settings.title }}</div>
                  {% endif %}
                  {% if block.settings.text != blank %}
                    <div class="hero-pillar-text milaura-text">{{ block.settings.text }}</div>
                  {% endif %}
                </div>
              {%- endif -%}
            </button>
            {% assign tab_index = tab_index | plus: 1 %}
          {% endif %}
        {% endfor %}

        <div class="hero-cta-row">
          <a href="#" class="milaura-cta hero-cta-main" data-hero-cta> Découvrir </a>
        </div>

        {% if section.settings.show_quiz_cta %}
          <div class="hero-quiz-cta-row">
            <div class="hero-quiz-bubble">
              <p class="hero-quiz-hint">{{ section.settings.quiz_cta_hint | default: 'Vous ne savez pas par où commencer ? Découvrez vos minéraux bien-être.' }}</p>
              <a href="{{ section.settings.quiz_cta_link | default: '/pages/diagnostic-emotionnel' }}" class="hero-quiz-cta">
                <span class="hero-quiz-cta-text">{{ section.settings.quiz_cta_label | default: 'Tester mon profil émotionnel' }}</span>
              </a>
            </div>
          </div>
        {% endif %}
      </div>

      <div class="hero-carousel-wrapper">
        <div class="hero-carousel-frame">
          <div class="hero-carousel" id="hero-carousel-{{ section.id }}">
            {% assign slide_index = 0 %}
            {% for block in section.blocks %}
              {% if block.type == 'universe' and block.settings.image != blank %}
                <div
                  class="hero-slide {% if slide_index == 0 %}is-active{% endif %}"
                  id="hero-slide-{{ section.id }}-{{ slide_index }}"
                  data-index="{{ slide_index }}"
                  role="tabpanel"
                  aria-labelledby="hero-tab-{{ section.id }}-{{ slide_index }}"
                  aria-hidden="{% if slide_index == 0 %}false{% else %}true{% endif %}"
                  {{ block.shopify_attributes }}
                >
                  {%- if slide_index == 0 -%}
                  {{
                    block.settings.image
                    | image_url: width: 1400
                    | image_tag: loading: 'eager', fetchpriority: 'high', alt: block.settings.image.alt
                    | default: block.settings.title
                    | default: 'Milaura'
                  }}
                {%- else -%}
                  {{
                    block.settings.image
                    | image_url: width: 1400
                    | image_tag: loading: 'lazy', alt: block.settings.image.alt
                    | default: block.settings.title
                    | default: 'Milaura'
                  }}
                {%- endif -%}
                </div>
                {% assign slide_index = slide_index | plus: 1 %}
              {% endif %}
            {% endfor %}

            {% assign universe_blocks = section.blocks | where: 'type', 'universe' %}
            {% if universe_blocks.size == 0 %}
              <div class="hero-slide is-active" role="tabpanel" aria-hidden="false">
                {{ 'image' | placeholder_svg_tag: 'hero-placeholder' }}
              </div>
            {% endif %}
          </div>

          <!-- Indicateurs de slide (dots) -->
          {% if universe_blocks.size > 1 %}
            <div class="hero-dots" aria-label="Navigation slides">
              {% for i in (0..universe_blocks.size) %}
                {% if i < universe_blocks.size %}
                  <button
                    type="button"
                    class="hero-dot {% if i == 0 %}is-active{% endif %}"
                    data-dot-index="{{ i }}"
                    aria-label="Aller à la slide {{ i | plus: 1 }}"
                  ></button>
                {% endif %}
              {% endfor %}
            </div>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Trust Badges intégrés -->
    {% assign has_trust_badges = false %}
    {% for block in section.blocks %}
      {% if block.type == 'trust_badge' %}
        {% assign has_trust_badges = true %}
        {% break %}
      {% endif %}
    {% endfor %}

    {% if has_trust_badges %}
      <div class="hero-trust-badges">
        {% for block in section.blocks %}
          {% if block.type == 'trust_badge' %}
            <div class="hero-trust-badge" {{ block.shopify_attributes }}>
              {% if block.settings.icon != blank %}
                <span class="badge-icon">{{ block.settings.icon }}</span>
              {% endif %}
              {% if block.settings.text != blank %}
                <span class="badge-text">{{ block.settings.text }}</span>
              {% endif %}
            </div>
          {% endif %}
        {% endfor %}
      </div>
    {% endif %}
  </div>
</div>

<script>
  (function () {
    const sectionId = '{{ section.id }}';
    const root = document.getElementById('MilauraHeroShowcase-' + sectionId);
    if (!root) return;

    const tabs = Array.from(root.querySelectorAll('.hero-tab[data-index]'));
    const slides = Array.from(root.querySelectorAll('.hero-slide[data-index]'));
    const dots = Array.from(root.querySelectorAll('.hero-dot[data-dot-index]'));
    const pillars = root.querySelector('.hero-pillars');
    const carousel = root.querySelector('.hero-carousel');
    const cta = root.querySelector('[data-hero-cta]');

    if (!tabs.length || !slides.length) return;

    const reducedMotion = window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches;

    // Assure index aligné
    const max = Math.min(tabs.length, slides.length);
    let currentIndex = 0;
    let autoplay = null;
    let resumeTimeout = null;

    const autoplayDuration = 3800; // plus doux qu'un 3000ms trop nerveux
    const resumeDelay = 9000;

    function updateCTA(index) {
      if (!cta) return;
      const tab = tabs[index];
      if (!tab) return;

      const label = (tab.getAttribute('data-cta-label') || '').trim();
      const link = (tab.getAttribute('data-cta-link') || '').trim();

      if (!label || !link || link === '#') {
        cta.classList.add('is-hidden');
        cta.setAttribute('href', '#');
        cta.textContent = 'Découvrir';
        return;
      }

      cta.classList.remove('is-hidden');
      cta.setAttribute('href', link);
      cta.textContent = label;
    }

    function updateDots(index) {
      dots.forEach((dot, i) => {
        if (i === index) {
          dot.classList.add('is-active');
        } else {
          dot.classList.remove('is-active');
        }
      });
    }

    function setActive(nextIndex) {
      if (nextIndex === currentIndex) return;
      if (nextIndex < 0 || nextIndex >= max) return;

      const prevTab = tabs[currentIndex];
      const nextTab = tabs[nextIndex];
      const prevSlide = slides[currentIndex];
      const nextSlide = slides[nextIndex];

      if (prevTab) {
        prevTab.classList.remove('is-active');
        prevTab.setAttribute('aria-selected', 'false');
      }
      if (prevSlide) {
        prevSlide.classList.remove('is-active');
        prevSlide.setAttribute('aria-hidden', 'true');
      }

      if (nextTab) {
        nextTab.classList.add('is-active');
        nextTab.setAttribute('aria-selected', 'true');
      }
      if (nextSlide) {
        nextSlide.classList.add('is-active');
        nextSlide.setAttribute('aria-hidden', 'false');
      }

      currentIndex = nextIndex;
      updateCTA(currentIndex);
      updateDots(currentIndex);
    }

    function goto(index) {
      window.requestAnimationFrame(function () {
        setActive(index);
      });
    }

    function next() {
      const n = (currentIndex + 1) % max;
      goto(n);
    }

    function stopAutoplay() {
      if (autoplay) {
        clearInterval(autoplay);
        autoplay = null;
      }
    }

    function startAutoplay() {
      if (reducedMotion) return;
      stopAutoplay();
      autoplay = setInterval(next, autoplayDuration);
    }

    function scheduleResume() {
      if (reducedMotion) return;
      if (resumeTimeout) clearTimeout(resumeTimeout);
      resumeTimeout = setTimeout(startAutoplay, resumeDelay);
    }

    const expandableMode = {{ section.settings.expandable_pillars | default: false }};

    function collapseAllTabs() {
      tabs.forEach(t => t.classList.remove('is-expanded'));
    }

    function toggleExpand(tab) {
      const wasExpanded = tab.classList.contains('is-expanded');
      collapseAllTabs();
      if (!wasExpanded) {
        tab.classList.add('is-expanded');
      }
    }

    // Event listeners for tabs
    tabs.slice(0, max).forEach((tab) => {
      tab.addEventListener('click', function (e) {
        e.preventDefault();
        stopAutoplay();
        const idx = parseInt(this.getAttribute('data-index'), 10);
        if (!isNaN(idx)) goto(idx);

        // Mode expandable: toggle l'expansion
        if (expandableMode) {
          toggleExpand(this);
        }

        scheduleResume();
      });

      tab.addEventListener('keydown', function (e) {
        let idx = currentIndex;
        if (e.key === 'ArrowRight' || e.key === 'ArrowDown') idx = (currentIndex + 1) % max;
        if (e.key === 'ArrowLeft' || e.key === 'ArrowUp') idx = (currentIndex - 1 + max) % max;
        if (e.key === 'Home') idx = 0;
        if (e.key === 'End') idx = max - 1;

        if (idx !== currentIndex) {
          e.preventDefault();
          stopAutoplay();
          goto(idx);
          tabs[idx].focus();
          scheduleResume();
        }
      });

      tab.addEventListener('focus', function () {
        stopAutoplay();
        scheduleResume();
      });
    });

    // Event listeners for dots
    dots.forEach((dot) => {
      dot.addEventListener('click', function (e) {
        e.preventDefault();
        stopAutoplay();
        const idx = parseInt(this.getAttribute('data-dot-index'), 10);
        if (!isNaN(idx)) goto(idx);
        scheduleResume();
      });
    });

    if (pillars) {
      pillars.addEventListener('mouseenter', stopAutoplay);
      pillars.addEventListener('mouseleave', startAutoplay);
    }
    if (carousel) {
      carousel.addEventListener('mouseenter', stopAutoplay);
      carousel.addEventListener('mouseleave', startAutoplay);
    }

    root.addEventListener('focusin', function () {
      stopAutoplay();
      scheduleResume();
    });

    // init
    updateCTA(0);
    updateDots(0);
    if (!reducedMotion) startAutoplay();
  })();
</script>

{% schema %}
{
  "name": "Milaura Hero Showcase",
  "tag": "section",
  "class": "section",
  "enabled_on": {
    "templates": ["*"]
  },
  "settings": [
    { "type": "header", "content": "📝 Textes du bandeau" },
    { "type": "text", "id": "kicker", "label": "Sur-titre", "default": "Découvrez" },
    {
      "type": "range",
      "id": "kicker_size",
      "label": "Taille sur-titre (desktop)",
      "min": 12,
      "max": 24,
      "step": 1,
      "unit": "px",
      "default": 14
    },
    {
      "type": "range",
      "id": "kicker_size_mobile",
      "label": "Taille sur-titre (mobile)",
      "min": 10,
      "max": 20,
      "step": 1,
      "unit": "px",
      "default": 12
    },
    {
      "type": "checkbox",
      "id": "kicker_stroke_enabled",
      "label": "Activer le contour sur le sur-titre",
      "default": false
    },
    {
      "type": "range",
      "id": "kicker_stroke_width",
      "label": "Épaisseur contour sur-titre",
      "min": 1,
      "max": 3,
      "step": 1,
      "unit": "px",
      "default": 1
    },
    {
      "type": "color",
      "id": "kicker_stroke_color",
      "label": "Couleur contour sur-titre",
      "default": "#000000"
    },
    { "type": "text", "id": "title", "label": "Titre principal", "default": "Votre univers énergétique" },
    {
      "type": "textarea",
      "id": "subtitle",
      "label": "Sous-titre descriptif",
      "default": "Pierres précieuses, bijoux uniques et rituels pour élever votre énergie"
    },

    { "type": "header", "content": "✏️ Typographie du bandeau" },
    {
      "type": "select",
      "id": "title_font",
      "label": "Police du titre",
      "options": [
        { "value": "'Dancing Script', cursive", "label": "Dancing Script (cursif)" },
        { "value": "'Playfair Display', serif", "label": "Playfair Display (élégant)" }
      ],
      "default": "'Dancing Script', cursive"
    },
    {
      "type": "range",
      "id": "title_size",
      "label": "Taille du titre",
      "min": 20,
      "max": 60,
      "step": 2,
      "unit": "px",
      "default": 40,
      "info": "Valeur en dixièmes de rem (40 = 4rem)"
    },
    { "type": "header", "content": "💫 Bulle glassmorphism (titre)" },
    {
      "type": "checkbox",
      "id": "title_bubble_enabled",
      "label": "Activer la bulle derrière le titre",
      "default": true
    },
    {
      "type": "color",
      "id": "title_bubble_color",
      "label": "Couleur de la bulle",
      "default": "#FFFFFF"
    },
    {
      "type": "range",
      "id": "title_bubble_opacity",
      "label": "Opacité de la bulle",
      "min": 10,
      "max": 100,
      "step": 5,
      "unit": "%",
      "default": 40
    },
    {
      "type": "range",
      "id": "title_bubble_blur",
      "label": "Intensité du flou (glassmorphism)",
      "min": 0,
      "max": 30,
      "step": 2,
      "unit": "px",
      "default": 12,
      "info": "0 = pas de flou, 30 = flou maximum"
    },
    {
      "type": "range",
      "id": "subtitle_size",
      "label": "Taille du sous-titre (desktop)",
      "min": 14,
      "max": 28,
      "step": 1,
      "unit": "px",
      "default": 18
    },
    {
      "type": "range",
      "id": "subtitle_size_mobile",
      "label": "Taille du sous-titre (mobile)",
      "min": 12,
      "max": 24,
      "step": 1,
      "unit": "px",
      "default": 15
    },
    {
      "type": "color",
      "id": "kicker_color",
      "label": "Couleur du sur-titre",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "banner_text_color",
      "label": "Couleur du titre",
      "default": "#FFFFFF"
    },
    {
      "type": "color",
      "id": "subtitle_color",
      "label": "Couleur du sous-titre",
      "default": "#000000",
      "info": "Séparé pour plus de contraste sur fond doré"
    },
    {
      "type": "header",
      "content": "🖊️ Contour du sous-titre"
    },
    {
      "type": "checkbox",
      "id": "subtitle_stroke_enabled",
      "label": "Activer le contour sur le sous-titre",
      "default": false
    },
    {
      "type": "range",
      "id": "subtitle_stroke_width",
      "label": "Épaisseur du contour",
      "min": 1,
      "max": 3,
      "step": 1,
      "unit": "px",
      "default": 1
    },
    {
      "type": "color",
      "id": "subtitle_stroke_color",
      "label": "Couleur du contour",
      "default": "#000000"
    },

    { "type": "header", "content": "🎨 Couleurs" },
    {
      "type": "color",
      "id": "tab_title_color",
      "label": "Couleur titres onglets",
      "default": "#1b1b1b"
    },
    {
      "type": "color",
      "id": "tab_text_color",
      "label": "Couleur texte onglets",
      "default": "#666666"
    },

    { "type": "header", "content": "🎯 CTA Quiz Secondaire" },
    {
      "type": "checkbox",
      "id": "show_quiz_cta",
      "label": "Afficher CTA Quiz",
      "default": true
    },
    {
      "type": "textarea",
      "id": "quiz_cta_hint",
      "label": "Texte d'accroche (bulle)",
      "default": "Vous ne savez pas par où commencer ? Découvrez vos minéraux bien-être."
    },
    {
      "type": "range",
      "id": "quiz_hint_size",
      "label": "Taille texte d'accroche",
      "min": 1,
      "max": 1.6,
      "step": 0.1,
      "unit": "rem",
      "default": 1.2
    },
    {
      "type": "text",
      "id": "quiz_cta_label",
      "label": "Texte du bouton",
      "default": "Tester mon profil émotionnel"
    },
    {
      "type": "url",
      "id": "quiz_cta_link",
      "label": "Lien CTA Quiz"
    },

    { "type": "header", "content": "👆 Mode Piliers Cliquables" },
    {
      "type": "checkbox",
      "id": "expandable_pillars",
      "label": "Activer les piliers expansibles",
      "default": false,
      "info": "Cliquer sur un pilier le déplie pour afficher description + CTA"
    },
    {
      "type": "checkbox",
      "id": "hide_main_cta",
      "label": "Masquer le CTA unique sous les piliers",
      "default": false,
      "info": "Utile si les CTA sont dans chaque pilier déplié"
    },

    { "type": "header", "content": "📱 Options Mobile" },
    {
      "type": "checkbox",
      "id": "hide_tab_text_mobile",
      "label": "Cacher descriptions onglets sur mobile",
      "default": true,
      "info": "Garde uniquement les titres pour une meilleure lisibilité"
    },

    { "type": "header", "content": "🖼️ Logo" },
    {
      "type": "image_picker",
      "id": "showcase_logo",
      "label": "Logo du showcase (optionnel)"
    },

    { "type": "header", "content": "⚙️ Legacy (ignoré si blocs utilisés)" },
    { "type": "text", "id": "pillar_1_icon", "label": "Pilier 1 icône", "default": "💎" },
    { "type": "text", "id": "pillar_1_title", "label": "Pilier 1 titre", "default": "Pierres & cristaux" },
    {
      "type": "textarea",
      "id": "pillar_1_text",
      "label": "Pilier 1 texte",
      "default": "Sélection de pierres naturelles de haute qualité, choisies à la main."
    },
    { "type": "url", "id": "pillar_1_link", "label": "Pilier 1 lien" },

    { "type": "text", "id": "pillar_2_icon", "label": "Pilier 2 icône", "default": "✨" },
    { "type": "text", "id": "pillar_2_title", "label": "Pilier 2 titre", "default": "Bijoux artisanaux" },
    {
      "type": "textarea",
      "id": "pillar_2_text",
      "label": "Pilier 2 texte",
      "default": "Créations artisanales uniques, chargées d'intention et d'énergie."
    },
    { "type": "url", "id": "pillar_2_link", "label": "Pilier 2 lien" },

    { "type": "text", "id": "pillar_3_icon", "label": "Pilier 3 icône", "default": "🕯️" },
    { "type": "text", "id": "pillar_3_title", "label": "Pilier 3 titre", "default": "Rituels & bougies" },
    {
      "type": "textarea",
      "id": "pillar_3_text",
      "label": "Pilier 3 texte",
      "default": "Expériences énergétiques pour transformer votre espace et votre bien-être."
    },
    { "type": "url", "id": "pillar_3_link", "label": "Pilier 3 lien" }
  ],
  "blocks": [
    {
      "type": "universe",
      "name": "Univers",
      "limit": 10,
      "settings": [
        { "type": "header", "content": "Onglet" },
        { "type": "text", "id": "tab_label", "label": "Label onglet", "default": "Pierres & cristaux" },
        { "type": "text", "id": "icon", "label": "Icône (Emoji)", "default": "💎" },

        { "type": "header", "content": "Contenu" },
        { "type": "text", "id": "title", "label": "Titre court", "default": "Pierres & cristaux" },
        {
          "type": "textarea",
          "id": "text",
          "label": "Texte descriptif (court)",
          "default": "Sélection de pierres naturelles de haute qualité, choisies à la main."
        },
        {
          "type": "textarea",
          "id": "long_description",
          "label": "Description longue (mode expand)",
          "info": "Affichée quand le pilier est déplié. Si vide, utilise le texte court."
        },

        { "type": "header", "content": "Slide" },
        { "type": "image_picker", "id": "image", "label": "Image de la slide" },

        { "type": "header", "content": "CTA" },
        { "type": "text", "id": "cta_label", "label": "Texte du bouton", "default": "Découvrir" },
        { "type": "url", "id": "cta_link", "label": "Lien du bouton" }
      ]
    },
    {
      "type": "trust_badge",
      "name": "Badge confiance",
      "limit": 6,
      "settings": [
        {
          "type": "text",
          "id": "icon",
          "label": "Icône (Emoji)",
          "default": "🇫🇷"
        },
        {
          "type": "text",
          "id": "text",
          "label": "Texte",
          "default": "Artisanat Français"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Milaura Hero Showcase",
      "blocks": [
        {
          "type": "universe",
          "settings": {
            "tab_label": "Pierres & minéraux",
            "icon": "💎",
            "title": "Pierres & minéraux",
            "text": "Sélection de pierres naturelles certifiées, choisies pour leurs vertus énergétiques.",
            "cta_label": "Découvrir"
          }
        },
        {
          "type": "universe",
          "settings": {
            "tab_label": "Bijoux & créations",
            "icon": "✨",
            "title": "Bijoux & créations",
            "text": "Créations artisanales uniques, chargées d'intention et d'énergie positive.",
            "cta_label": "Découvrir"
          }
        },
        {
          "type": "universe",
          "settings": {
            "tab_label": "Bougies & senteurs",
            "icon": "🕯️",
            "title": "Bougies & senteurs",
            "text": "Bougies artisanales aux huiles essentielles pour créer votre atmosphère.",
            "cta_label": "Découvrir"
          }
        },
        {
          "type": "universe",
          "settings": {
            "tab_label": "Rituels & bien-être",
            "icon": "🧘",
            "title": "Rituels & bien-être",
            "text": "Guides et accessoires pour vos rituels de reconnexion et de self-care.",
            "cta_label": "Découvrir"
          }
        },
        {
          "type": "trust_badge",
          "settings": {
            "icon": "🇫🇷",
            "text": "Artisanat Français"
          }
        },
        {
          "type": "trust_badge",
          "settings": {
            "icon": "💎",
            "text": "Pierres Certifiées"
          }
        },
        {
          "type": "trust_badge",
          "settings": {
            "icon": "🚚",
            "text": "Livraison Offerte dès 39€"
          }
        },
        {
          "type": "trust_badge",
          "settings": {
            "icon": "💝",
            "text": "Emballage Cadeau"
          }
        }
      ]
    }
  ]
}
{% endschema %}
