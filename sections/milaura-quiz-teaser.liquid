{% comment %}
  MILAURA QUIZ TEASER
  Section d'accroche pour la homepage qui redirige vers la page quiz complete
  Design elegant avec expert block et CTA fort
{% endcomment %}

{% style %}
  /* ============================================
     MILAURA QUIZ TEASER - SECTION HOMEPAGE
     ============================================ */

  #MilauraQuizTeaser-{{ section.id }} {
    width: 100%;
    padding: 1px var(--milaura-spacing-sm) var(--milaura-spacing-md);
    background: transparent;
    margin-top: 0;
    margin-bottom: var(--milaura-spacing-sm);
    position: relative;
  }

  /* Ligne dorée animée au-dessus de la section */
  #MilauraQuizTeaser-{{ section.id }} .section-gold-separator {
    position: absolute;
    top: -5px;
    left: 50%;
    transform: translateX(-50%);
    width: 200px;
    height: 4px;
    background: #C0A062;
    border-radius: 2px;
    z-index: 9999;
    transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1), background 0.6s ease;
    box-shadow: 0 0 10px rgba(192, 160, 98, 0.8);
  }

  #MilauraQuizTeaser-{{ section.id }} .section-gold-separator.is-expanded {
    width: 90%;
    background: linear-gradient(90deg, transparent 0%, rgba(214, 176, 96, 0.6) 10%, rgba(214, 176, 96, 0.8) 50%, rgba(214, 176, 96, 0.6) 90%, transparent 100%);
  }

  @media screen and (max-width: 768px) {
    #MilauraQuizTeaser-{{ section.id }} .section-gold-separator {
      width: 80px;
    }

    #MilauraQuizTeaser-{{ section.id }} .section-gold-separator.is-expanded {
      width: 85%;
    }
  }

  /* Container principal avec effet glassmorphism */
  #MilauraQuizTeaser-{{ section.id }} .teaser-container {
    position: relative;
    text-align: center;
    max-width: 100%;
    width: 100%;
    margin: 0 auto;
  }

  /* Kicker / Surtitre */
  #MilauraQuizTeaser-{{ section.id }} .teaser-kicker {
    font-family: var(--milaura-font-body);
    color: var(--milaura-gold);
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 2px;
    margin-bottom: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
  }

  #MilauraQuizTeaser-{{ section.id }} .teaser-kicker::before,
  #MilauraQuizTeaser-{{ section.id }} .teaser-kicker::after {
    content: '';
    width: 25px;
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--milaura-gold), transparent);
  }

  /* Titre principal - utilise les settings du customizer */
  #MilauraQuizTeaser-{{ section.id }} .teaser-title {
    font-family: {{ section.settings.title_font }};
    color: {{ section.settings.title_color }};
    font-size: {{ section.settings.title_size }}rem;
    font-weight: 700;
    margin-bottom: 24px;
    line-height: 1.1;
  }

  /* Sous-titre - utilise les settings du customizer */
  #MilauraQuizTeaser-{{ section.id }} .teaser-subtitle {
    font-family: var(--milaura-font-body);
    color: {{ section.settings.subtitle_color }};
    font-size: {{ section.settings.subtitle_size }}rem;
    line-height: 1.6;
    margin-bottom: 32px;
    max-width: 1000px;
    margin-left: auto;
    margin-right: auto;
  }

  /* Bloc Expert */
  #MilauraQuizTeaser-{{ section.id }} .teaser-expert-block {
    background: rgba(255, 255, 255, 0.6);
    backdrop-filter: blur(15px);
    -webkit-backdrop-filter: blur(15px);
    border-radius: var(--milaura-border-radius);
    border: 1px solid rgba(192, 160, 98, 0.2);
    padding: 16px 20px;
    margin: 24px auto;
    max-width: 450px;
    display: flex;
    align-items: center;
    gap: 16px;
    text-align: left;
    transition: all 0.4s cubic-bezier(0.165, 0.84, 0.44, 1);
  }

  @media (min-width: 992px) {
    #MilauraQuizTeaser-{{ section.id }} .teaser-expert-block {
      max-width: 1000px;
      padding: 32px 48px;
      gap: 32px;
    }
  }

  #MilauraQuizTeaser-{{ section.id }} .teaser-expert-block:hover {
    transform: translateY(-3px);
    box-shadow: 0 15px 40px rgba(192, 160, 98, 0.2);
    border-color: rgba(192, 160, 98, 0.4);
  }

  #MilauraQuizTeaser-{{ section.id }} .teaser-expert-image {
    width: 70px;
    height: 70px;
    border-radius: 50%;
    object-fit: cover;
    border: 2px solid var(--milaura-gold);
    flex-shrink: 0;
    box-shadow: 0 4px 15px rgba(192, 160, 98, 0.25);
  }

  @media (min-width: 992px) {
    #MilauraQuizTeaser-{{ section.id }} .teaser-expert-image {
      width: 120px;
      height: 120px;
    }
  }

  #MilauraQuizTeaser-{{ section.id }} .teaser-expert-info {
    flex: 1;
  }

  /* Nom de l'experte - customizable */
  #MilauraQuizTeaser-{{ section.id }} .teaser-expert-name {
    font-family: var(--milaura-font-heading);
    color: {{ section.settings.expert_name_color | default: '#1b1b1b' }};
    font-size: {{ section.settings.expert_name_size | default: 1.3 }}rem;
    font-weight: 700;
    margin-bottom: 4px;
  }

  /* Titre de l'experte - customizable */
  #MilauraQuizTeaser-{{ section.id }} .teaser-expert-title {
    font-family: var(--milaura-font-body);
    color: {{ section.settings.expert_title_color | default: '#C0A062' }};
    font-size: {{ section.settings.expert_title_size | default: 0.9 }}rem;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 6px;
  }

  /* Citation de l'experte - customizable */
  #MilauraQuizTeaser-{{ section.id }} .teaser-expert-text {
    font-family: var(--milaura-font-body);
    color: {{ section.settings.expert_quote_color | default: '#666666' }};
    font-size: {{ section.settings.expert_quote_size | default: 1 }}rem;
    line-height: 1.4;
    font-style: italic;
  }

  /* Bloc Stats / Social Proof */
  #MilauraQuizTeaser-{{ section.id }} .teaser-stats {
    display: flex;
    justify-content: center;
    gap: 32px;
    margin: 18px 0;
    flex-wrap: wrap;
  }

  #MilauraQuizTeaser-{{ section.id }} .teaser-stat {
    text-align: center;
  }

  #MilauraQuizTeaser-{{ section.id }} .teaser-stat-number {
    font-family: var(--milaura-font-heading);
    color: var(--milaura-gold);
    font-size: 2rem;
    font-weight: 700;
    line-height: 1;
    margin-bottom: 4px;
  }

  #MilauraQuizTeaser-{{ section.id }} .teaser-stat-label {
    font-family: var(--milaura-font-body);
    color: var(--milaura-text-light);
    font-size: 0.85rem;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  /* CTA Principal - style milaura-cta doré avec texte noir */
  #MilauraQuizTeaser-{{ section.id }} .teaser-cta-wrapper {
    margin-top: 24px;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 16px;
  }

  #MilauraQuizTeaser-{{ section.id }} .teaser-cta {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    font-family: 'Lato', -apple-system, BlinkMacSystemFont, sans-serif;
    font-size: 1rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    padding: 14px 32px;
    border-radius: 999px;
    text-decoration: none !important;
    color: #000 !important;
    background: linear-gradient(
      135deg,
      rgba(255, 240, 200, 0.95) 0%,
      rgba(214, 176, 96, 0.95) 25%,
      rgba(255, 232, 172, 0.95) 50%,
      rgba(214, 176, 96, 0.95) 75%,
      rgba(255, 240, 200, 0.95) 100%
    );
    border: 1px solid rgba(192, 160, 98, 0.4);
    box-shadow: 0 4px 15px rgba(192, 160, 98, 0.25);
    transition: all 0.3s ease;
    cursor: pointer;
  }

  #MilauraQuizTeaser-{{ section.id }} .teaser-cta:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(192, 160, 98, 0.35);
    border-color: rgba(192, 160, 98, 0.6);
  }

  /* Note sous le CTA - style kicker avec lignes dorées */
  #MilauraQuizTeaser-{{ section.id }} .teaser-note {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
    font-family: var(--milaura-font-body);
    color: var(--milaura-gold);
    font-size: 0.9rem;
    text-transform: uppercase;
    letter-spacing: 2px;
    margin: 0;
  }

  #MilauraQuizTeaser-{{ section.id }} .teaser-note::before,
  #MilauraQuizTeaser-{{ section.id }} .teaser-note::after {
    content: '';
    width: 25px;
    height: 1px;
    background: linear-gradient(90deg, transparent, var(--milaura-gold), transparent);
  }

  /* --- RESPONSIVE TABLETTE --- */
  @media screen and (max-width: 1024px) {
    #MilauraQuizTeaser-{{ section.id }} .teaser-title {
      font-size: {{ section.settings.title_size | times: 0.85 }}rem;
    }

    #MilauraQuizTeaser-{{ section.id }} .teaser-expert-block {
      max-width: 100%;
    }
  }

  /* --- RESPONSIVE MOBILE --- */
  @media screen and (max-width: 768px) {
    #MilauraQuizTeaser-{{ section.id }} {
      padding: var(--milaura-spacing-sm) var(--milaura-spacing-xs);
      margin-top: 0;
      margin-bottom: var(--milaura-spacing-sm);
    }

    #MilauraQuizTeaser-{{ section.id }} .teaser-kicker {
      margin-bottom: 6px;
      font-size: 0.85rem;
    }

    #MilauraQuizTeaser-{{ section.id }} .teaser-title {
      font-size: {{ section.settings.title_size | times: 0.65 }}rem;
      margin-bottom: var(--milaura-spacing-sm);
    }

    #MilauraQuizTeaser-{{ section.id }} .teaser-subtitle {
      font-size: 0.95rem;
      margin-bottom: var(--milaura-spacing-sm);
      line-height: 1.4;
    }

    #MilauraQuizTeaser-{{ section.id }} .teaser-expert-block {
      flex-direction: row;
      text-align: left;
      padding: var(--milaura-spacing-sm);
      margin: var(--milaura-spacing-sm) auto;
      gap: var(--milaura-spacing-sm);
    }

    #MilauraQuizTeaser-{{ section.id }} .teaser-expert-image {
      width: 60px;
      height: 60px;
    }

    #MilauraQuizTeaser-{{ section.id }} .teaser-expert-info {
      text-align: left;
    }

    #MilauraQuizTeaser-{{ section.id }} .teaser-expert-name {
      font-size: 1rem;
      margin-bottom: 2px;
    }

    #MilauraQuizTeaser-{{ section.id }} .teaser-expert-title {
      font-size: 0.85rem;
      margin-bottom: 4px;
    }

    #MilauraQuizTeaser-{{ section.id }} .teaser-expert-text {
      font-size: 0.9rem;
      line-height: 1.3;
    }

    #MilauraQuizTeaser-{{ section.id }} .teaser-stats {
      gap: var(--milaura-spacing-md);
      margin: var(--milaura-spacing-sm) 0;
    }

    #MilauraQuizTeaser-{{ section.id }} .teaser-stat-number {
      font-size: 1.4rem;
    }

    #MilauraQuizTeaser-{{ section.id }} .teaser-stat-label {
      font-size: 0.85rem;
    }

    #MilauraQuizTeaser-{{ section.id }} .teaser-cta-wrapper {
      margin-top: var(--milaura-spacing-sm);
      gap: 12px;
    }

    #MilauraQuizTeaser-{{ section.id }} .teaser-cta {
      width: 100%;
      padding: 14px 24px;
      font-size: 1rem;
    }

    #MilauraQuizTeaser-{{ section.id }} .teaser-note {
      font-size: 0.8rem;
    }
  }

  /* --- TRES PETIT MOBILE --- */
  @media screen and (max-width: 380px) {
    #MilauraQuizTeaser-{{ section.id }} {
      padding: var(--milaura-spacing-xs) var(--milaura-spacing-xs);
    }

    #MilauraQuizTeaser-{{ section.id }} .teaser-title {
      font-size: 1.65rem;
    }

    #MilauraQuizTeaser-{{ section.id }} .teaser-stats {
      flex-direction: row;
      gap: var(--milaura-spacing-sm);
    }

    #MilauraQuizTeaser-{{ section.id }} .teaser-stat-number {
      font-size: 1.2rem;
    }

    #MilauraQuizTeaser-{{ section.id }} .teaser-cta {
      padding: 12px 20px;
      font-size: 0.95rem;
    }
  }

  /* Reduced motion */
  @media (prefers-reduced-motion: reduce) {
    #MilauraQuizTeaser-{{ section.id }} .teaser-expert-block,
    #MilauraQuizTeaser-{{ section.id }} .teaser-cta {
      transition: none;
    }
  }
{% endstyle %}

<section
  id="MilauraQuizTeaser-{{ section.id }}"
  class="milaura-quiz-teaser"
  aria-label="{{ section.settings.title }}"
>
  <!-- Ligne dorée animée -->
  <div class="section-gold-separator" data-gold-separator style="display:block; position:absolute; top:-5px; left:50%; transform:translateX(-50%); width:200px; height:4px; background:#C0A062; z-index:9999; box-shadow:0 0 10px rgba(192,160,98,0.8);"></div>

  <div class="page-width">
    <div class="teaser-container milaura-section-card">

      {%- comment -%} Kicker {%- endcomment -%}
      {%- if section.settings.kicker != blank -%}
        <div class="teaser-kicker">{{ section.settings.kicker }}</div>
      {%- endif -%}

      {%- comment -%} Titre principal {%- endcomment -%}
      {%- if section.settings.title != blank -%}
        <h2 class="teaser-title">{{ section.settings.title }}</h2>
      {%- endif -%}

      {%- comment -%} Sous-titre {%- endcomment -%}
      {%- if section.settings.subtitle != blank -%}
        <div class="teaser-subtitle">{{ section.settings.subtitle }}</div>
      {%- endif -%}

      {%- comment -%} Bloc Expert {%- endcomment -%}
      {%- if section.settings.show_expert and section.settings.expert_image != blank -%}
        <div class="teaser-expert-block">
          <img
            src="{{ section.settings.expert_image | image_url: width: 300 }}"
            alt="{{ section.settings.expert_name }}"
            class="teaser-expert-image"
            width="120"
            height="120"
            loading="lazy"
          >
          <div class="teaser-expert-info">
            {%- if section.settings.expert_name != blank -%}
              <div class="teaser-expert-name">{{ section.settings.expert_name }}</div>
            {%- endif -%}
            {%- if section.settings.expert_title != blank -%}
              <div class="teaser-expert-title">{{ section.settings.expert_title }}</div>
            {%- endif -%}
            {%- if section.settings.expert_quote != blank -%}
              <div class="teaser-expert-text">"{{ section.settings.expert_quote }}"</div>
            {%- endif -%}
          </div>
        </div>
      {%- endif -%}

      {%- comment -%} Stats / Social Proof {%- endcomment -%}
      {%- if section.settings.show_stats -%}
        <div class="teaser-stats">
          {%- if section.settings.stat_1_number != blank -%}
            <div class="teaser-stat">
              <div class="teaser-stat-number">{{ section.settings.stat_1_number }}</div>
              <div class="teaser-stat-label">{{ section.settings.stat_1_label }}</div>
            </div>
          {%- endif -%}
          {%- if section.settings.stat_2_number != blank -%}
            <div class="teaser-stat">
              <div class="teaser-stat-number">{{ section.settings.stat_2_number }}</div>
              <div class="teaser-stat-label">{{ section.settings.stat_2_label }}</div>
            </div>
          {%- endif -%}
          {%- if section.settings.stat_3_number != blank -%}
            <div class="teaser-stat">
              <div class="teaser-stat-number">{{ section.settings.stat_3_number }}</div>
              <div class="teaser-stat-label">{{ section.settings.stat_3_label }}</div>
            </div>
          {%- endif -%}
        </div>
      {%- endif -%}

      {%- comment -%} CTA Principal {%- endcomment -%}
      <div class="teaser-cta-wrapper">
        <a href="{{ section.settings.cta_link }}" class="teaser-cta">
          {{ section.settings.cta_label | default: 'Faire mon diagnostic' }}
        </a>

        {%- if section.settings.cta_note != blank -%}
          <p class="teaser-note">{{ section.settings.cta_note }}</p>
        {%- endif -%}
      </div>

    </div>
  </div>
</section>

<script>
  (function() {
    const sectionId = '{{ section.id }}';
    const section = document.getElementById('MilauraQuizTeaser-' + sectionId);
    if (!section) return;

    const separator = section.querySelector('[data-gold-separator]');
    if (!separator) return;

    // Vérifie prefers-reduced-motion
    if (window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
      separator.classList.add('is-expanded');
      return;
    }

    // IntersectionObserver pour animer au scroll
    const observer = new IntersectionObserver(
      function(entries) {
        entries.forEach(function(entry) {
          if (entry.isIntersecting) {
            separator.classList.add('is-expanded');
          } else {
            separator.classList.remove('is-expanded');
          }
        });
      },
      {
        rootMargin: '-10% 0px -30% 0px',
        threshold: 0
      }
    );

    observer.observe(section);
  })();
</script>

{% schema %}
{
  "name": "Milaura Quiz Teaser",
  "tag": "section",
  "class": "milaura-section",
  "settings": [
    {
      "type": "header",
      "content": "Contenu principal"
    },
    {
      "type": "text",
      "id": "kicker",
      "label": "Surtitre",
      "default": "Decouvrez votre profil"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Titre",
      "default": "Quel est ton besoin emotionnel ?"
    },
    {
      "type": "textarea",
      "id": "subtitle",
      "label": "Sous-titre",
      "default": "Reponds a quelques questions et decouvre la bougie qui correspond a ton etat emotionnel du moment."
    },
    {
      "type": "header",
      "content": "Style titre"
    },
    {
      "type": "select",
      "id": "title_font",
      "label": "Police du titre",
      "options": [
        { "value": "var(--milaura-font-heading)", "label": "Playfair Display" },
        { "value": "'Dancing Script', cursive", "label": "Dancing Script" },
        { "value": "var(--milaura-font-body)", "label": "Lato" }
      ],
      "default": "var(--milaura-font-heading)"
    },
    {
      "type": "range",
      "id": "title_size",
      "label": "Taille du titre",
      "min": 1.5,
      "max": 6,
      "step": 0.1,
      "unit": "rem",
      "default": 3.5
    },
    {
      "type": "color",
      "id": "title_color",
      "label": "Couleur du titre",
      "default": "#C0A062"
    },
    {
      "type": "range",
      "id": "subtitle_size",
      "label": "Taille du sous-titre",
      "min": 0.9,
      "max": 3,
      "step": 0.1,
      "unit": "rem",
      "default": 1.4
    },
    {
      "type": "color",
      "id": "subtitle_color",
      "label": "Couleur du sous-titre",
      "default": "#1b1b1b"
    },
    {
      "type": "header",
      "content": "Bloc Experte"
    },
    {
      "type": "checkbox",
      "id": "show_expert",
      "label": "Afficher le bloc experte",
      "default": true
    },
    {
      "type": "image_picker",
      "id": "expert_image",
      "label": "Photo de l'experte"
    },
    {
      "type": "text",
      "id": "expert_name",
      "label": "Nom de l'experte",
      "default": "Lorraine Vidal"
    },
    {
      "type": "range",
      "id": "expert_name_size",
      "label": "Taille nom experte",
      "min": 1,
      "max": 4,
      "step": 0.1,
      "unit": "rem",
      "default": 1.3
    },
    {
      "type": "color",
      "id": "expert_name_color",
      "label": "Couleur nom experte",
      "default": "#1b1b1b"
    },
    {
      "type": "text",
      "id": "expert_title",
      "label": "Titre de l'experte",
      "default": "Fondatrice & Experte en aromatherapie"
    },
    {
      "type": "range",
      "id": "expert_title_size",
      "label": "Taille titre experte",
      "min": 0.7,
      "max": 2,
      "step": 0.1,
      "unit": "rem",
      "default": 0.9
    },
    {
      "type": "color",
      "id": "expert_title_color",
      "label": "Couleur titre experte",
      "default": "#C0A062"
    },
    {
      "type": "text",
      "id": "expert_quote",
      "label": "Citation courte",
      "default": "Je t'accompagne dans cette decouverte de ton profil unique."
    },
    {
      "type": "range",
      "id": "expert_quote_size",
      "label": "Taille citation",
      "min": 0.8,
      "max": 3,
      "step": 0.1,
      "unit": "rem",
      "default": 1
    },
    {
      "type": "color",
      "id": "expert_quote_color",
      "label": "Couleur citation",
      "default": "#666666"
    },
    {
      "type": "header",
      "content": "Social Proof (Stats)"
    },
    {
      "type": "checkbox",
      "id": "show_stats",
      "label": "Afficher les statistiques",
      "default": true
    },
    {
      "type": "text",
      "id": "stat_1_number",
      "label": "Stat 1 - Nombre",
      "default": "2min"
    },
    {
      "type": "text",
      "id": "stat_1_label",
      "label": "Stat 1 - Label",
      "default": "Duree du quiz"
    },
    {
      "type": "text",
      "id": "stat_2_number",
      "label": "Stat 2 - Nombre",
      "default": "5"
    },
    {
      "type": "text",
      "id": "stat_2_label",
      "label": "Stat 2 - Label",
      "default": "Profils emotionnels"
    },
    {
      "type": "text",
      "id": "stat_3_number",
      "label": "Stat 3 - Nombre",
      "default": "98%"
    },
    {
      "type": "text",
      "id": "stat_3_label",
      "label": "Stat 3 - Label",
      "default": "Clients satisfaits"
    },
    {
      "type": "header",
      "content": "Bouton CTA"
    },
    {
      "type": "text",
      "id": "cta_label",
      "label": "Texte du bouton",
      "default": "Faire mon diagnostic emotionnel"
    },
    {
      "type": "url",
      "id": "cta_link",
      "label": "Lien du bouton"
    },
    {
      "type": "text",
      "id": "cta_note",
      "label": "Note sous le bouton",
      "default": "Gratuit - Sans engagement"
    }
  ],
  "presets": [
    {
      "name": "Milaura Quiz Teaser"
    }
  ]
}
{% endschema %}
