{%- comment -%}
  MILAURA CART DRAWER RECOS
  Affichage recommandations dans le panier (drawer)
  À inclure avant le bouton "Passer commande"
{%- endcomment -%}

{%- if cart.item_count > 0 -%}
  {%- assign first_item = cart.items.first -%}

  {% render 'milaura-recos-engine',
    current_product: first_item.product,
    max_recos: 2
  %}

  {% if recommended_products.size > 0 %}
    <div class="milaura-cart-recos">
      <p class="milaura-cart-recos-title">Complétez votre rituel</p>

      <div class="milaura-cart-recos-grid">
        {% for reco in recommended_products %}
          <div class="milaura-cart-reco-card">
            <a href="{{ reco.url }}" class="milaura-cart-reco-link">
              <div class="milaura-cart-reco-image">
                {% if reco.featured_image %}
                  <img src="{{ reco.featured_image | image_url: width: 200 }}" alt="{{ reco.title }}" loading="lazy">
                {% else %}
                  {{ 'product-1' | placeholder_svg_tag: 'placeholder-svg' }}
                {% endif %}
              </div>

              <div class="milaura-cart-reco-info">
                <h4 class="milaura-cart-reco-title">{{ reco.title }}</h4>
                <p class="milaura-cart-reco-price">{{ reco.price | money }}</p>
              </div>
            </a>
          </div>
        {% endfor %}
      </div>
    </div>

    <style>
      .milaura-cart-recos {
        padding: 1.5rem 0;
        margin: 1.5rem 0;
        border-top: 1px solid rgba(192, 160, 98, 0.2);
      }

      .milaura-cart-recos-title {
        font-family: var(--font-heading-family, 'Playfair Display'), serif;
        font-size: 1.125rem;
        margin: 0 0 1rem 0;
        color: var(--milaura-text, #000000);
      }

      .milaura-cart-recos-grid {
        display: grid;
        gap: 1rem;
      }

      .milaura-cart-reco-card {
        background: rgba(255, 255, 255, 0.5);
        border-radius: 12px;
        padding: 1rem;
        border: 1px solid rgba(192, 160, 98, 0.15);
        transition: all 0.3s ease;
      }

      .milaura-cart-reco-card:hover {
        border-color: var(--milaura-gold, #C0A062);
        background: rgba(255, 255, 255, 0.7);
      }

      .milaura-cart-reco-link {
        text-decoration: none;
        color: inherit;
        display: flex;
        gap: 1rem;
        align-items: center;
      }

      .milaura-cart-reco-image {
        width: 80px;
        height: 80px;
        flex-shrink: 0;
        border-radius: 8px;
        overflow: hidden;
      }

      .milaura-cart-reco-image img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .milaura-cart-reco-info {
        flex: 1;
      }

      .milaura-cart-reco-title {
        font-size: 0.9375rem;
        font-weight: 600;
        margin: 0 0 0.25rem 0;
        color: var(--milaura-text, #000000);
      }

      .milaura-cart-reco-price {
        font-size: 0.875rem;
        color: var(--milaura-gold, #C0A062);
        margin: 0;
        font-weight: 600;
      }
    </style>
  {% endif %}
{%- endif -%}
