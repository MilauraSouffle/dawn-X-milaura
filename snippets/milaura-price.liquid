{%- comment -%}
  MILAURA PRICE
  Snippet reutilisable pour affichage prix

  Params:
  - product: objet produit
  - variant: objet variant (optionnel, sinon first_available)
  - show_compare: afficher prix barre (default: true)
  - size: 'sm' | 'md' | 'lg' (default: 'md')
  - class: classes CSS additionnelles
{%- endcomment -%}

{%- liquid
  assign show_compare = show_compare | default: true
  assign size = size | default: 'md'
  assign extra_class = class | default: ''

  if variant == blank
    assign variant = product.selected_or_first_available_variant
  endif

  assign has_discount = false
  if variant.compare_at_price > variant.price
    assign has_discount = true
  endif

  assign price_class = 'milaura-price milaura-price--' | append: size
  if extra_class != blank
    assign price_class = price_class | append: ' ' | append: extra_class
  endif
-%}

<div class="{{ price_class }}">
  {%- if has_discount and show_compare -%}
    <span class="milaura-price__compare">
      <span class="visually-hidden">Prix habituel</span>
      {{ variant.compare_at_price | money }}
    </span>
    <span class="milaura-price__sale">
      <span class="visually-hidden">Prix promo</span>
      {{ variant.price | money }}
    </span>
  {%- else -%}
    <span class="milaura-price__regular">
      {{ variant.price | money }}
    </span>
  {%- endif -%}

  {%- if variant.unit_price_measurement -%}
    <span class="milaura-price__unit">
      <span class="visually-hidden">Prix unitaire</span>
      {{ variant.unit_price | money }}/{{ variant.unit_price_measurement.reference_unit }}
    </span>
  {%- endif -%}
</div>
